<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="HasAgtLawPolDetail" >

  <resultMap id="BaseResultMap" class="com.tlg.prpins.entity.HasAgtLawPolDetail" >
    <result column="OID" property="oid" jdbcType="DECIMAL" />
    <result column="BATCH_NO" property="batchNo" jdbcType="VARCHAR" />
    <result column="PROPOSALNO" property="proposalno" jdbcType="VARCHAR" />
    <result column="POLICYNO" property="policyno" jdbcType="VARCHAR" />
    <result column="APPLINAME" property="appliname" jdbcType="VARCHAR" />
    <result column="INSUREDNAME" property="insuredname" jdbcType="VARCHAR" />
    <result column="IDENTIFYNUMBER" property="identifynumber" jdbcType="VARCHAR" />
    <result column="BIRTHDAY" property="birthday" jdbcType="VARCHAR" />
    <result column="INSUREDIDENTITY" property="insuredidentity" jdbcType="VARCHAR" />
    <result column="STARTDATE" property="startdate" jdbcType="VARCHAR" />
    <result column="STARTHOUR" property="starthour" jdbcType="VARCHAR" />
    <result column="ENDDATE" property="enddate" jdbcType="VARCHAR" />
    <result column="TA00TA0D" property="ta00ta0d" jdbcType="DECIMAL" />
    <result column="TA01TA0E" property="ta01ta0e" jdbcType="DECIMAL" />
    <result column="TR45" property="tr45" jdbcType="DECIMAL" />
    <result column="INSUREDTOTALDAYS" property="insuredtotaldays" jdbcType="DECIMAL" />
    <result column="SUMPREMIUM" property="sumpremium" jdbcType="DECIMAL" />
    <result column="TRAVELPALCE" property="travelpalce" jdbcType="VARCHAR" />
    <result column="UNDERWRITEENDDATE" property="underwriteenddate" jdbcType="VARCHAR" />
    <result column="BENEFIT_INSUREDNAME" property="benefitInsuredname" jdbcType="VARCHAR" />
    <result column="BENEFIT_INSUREDIDENTITY" property="benefitInsuredidentity" jdbcType="VARCHAR" />
    <result column="TOTALINSUREDNO" property="totalinsuredno" jdbcType="VARCHAR" />
    <result column="HANDLERIDENTIFYNUMBER" property="handleridentifynumber" jdbcType="VARCHAR" />
    <result column="CHANNELCODE" property="channelcode" jdbcType="VARCHAR" />
  </resultMap>

  <!-- mantis：OTH0182，處理人員：DP0714，錠嵂非專案回饋檔新增業務來源和商品 -->
  <select id="selectForGenFile" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select * from HAS_AGT_LAW_POL_DETAIL OP
      join HAS_AGT_BATCH_DTL DTL on OP.BATCH_NO = DTL.BATCH_NO and OP.policyno = DTL.CORE_NO
     where OP.BATCH_NO = #batchNo#
       and DTL.BUSINESSNATURE = #businessNature#
       and DTL.ORDERSEQ_STATUS IN ('01','02')
     order by OP.policyno
  </select>

  <select id="selectByParams" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select * from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL_DETAIL
    <dynamic prepend="WHERE">
    	<isNotEmpty prepend="AND" property="oid">
		OID = #oid:DECIMAL#
		</isNotEmpty>
      <isNotNull prepend="AND" property="batchNo">
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="policyno">
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
    </dynamic>
    <isNotEmpty property="sortBy">
		ORDER BY $sortBy$ $sortType$ 
	</isNotEmpty>
  </select>

  <select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map" >
    <include refid="Utils.sql1" />
    select * from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL_DETAIL
    <dynamic prepend="WHERE" >
      <isNotEmpty prepend="AND" property="oid">
		OID = #oid:DECIMAL#
		</isNotEmpty>
      <isNotNull prepend="AND" property="batchNo">
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="policyno">
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
      <include refid="Utils.sql2" />
    </dynamic>
  </select>

  <select id="selectByUK" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select * from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL_DETAIL
    where OID = #oid:DECIMAL#
  </select>

  <select id="count" parameterClass="java.util.Map" resultClass="java.lang.Integer">
    select count(*) from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL_DETAIL
    <dynamic prepend="WHERE">
      <isNotNull prepend="AND" property="batchNo">
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="policyno">
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
    </dynamic>
  </select>

  <insert id="insert" parameterClass="com.tlg.prpins.entity.HasAgtLawPolDetail" >
    insert into HAS_AGT_LAW_POL_DETAIL (OID, BATCH_NO, PROPOSALNO, POLICYNO,
      APPLINAME, INSUREDNAME, IDENTIFYNUMBER, BIRTHDAY, INSUREDIDENTITY,
      STARTDATE, STARTHOUR, ENDDATE, TA00TA0D, TA01TA0E,
      TR45, INSUREDTOTALDAYS, SUMPREMIUM, TRAVELPALCE, UNDERWRITEENDDATE,
      BENEFIT_INSUREDNAME, BENEFIT_INSUREDIDENTITY, TOTALINSUREDNO, HANDLERIDENTIFYNUMBER, CHANNELCODE)
    values (#oid:DECIMAL#, #batchNo:VARCHAR#, #proposalno:VARCHAR#, #policyno:VARCHAR#,
      #appliname:VARCHAR#, #insuredname:VARCHAR#, #identifynumber:VARCHAR#, #birthday:VARCHAR#, #insuredidentity:VARCHAR#,
      #startdate:VARCHAR#, #starthour:VARCHAR#, #enddate:VARCHAR#, #ta00ta0d:DECIMAL#, #ta01ta0e:DECIMAL#,
      #tr45:DECIMAL#, #insuredtotaldays:DECIMAL#, #sumpremium:DECIMAL#, #travelpalce:VARCHAR#, #underwriteenddate:VARCHAR#,
      #benefitInsuredname:VARCHAR#, #benefitInsuredidentity:VARCHAR#, #totalinsuredno:VARCHAR#, #handleridentifynumber:VARCHAR#, #channelcode:VARCHAR#)
  </insert>

  <update id="update" parameterClass="com.tlg.prpins.entity.HasAgtLawPolDetail" >
    update HAS_AGT_LAW_POL_DETAIL
    <dynamic prepend="set" >
      <isNotNull prepend="," property="batchNo" >
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="proposalno" >
        PROPOSALNO = #proposalno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="policyno" >
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="appliname" >
        APPLINAME = #appliname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="insuredname" >
        INSUREDNAME = #insuredname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="identifynumber" >
        IDENTIFYNUMBER = #identifynumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="birthday" >
        BIRTHDAY = #birthday:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="insuredidentity" >
        INSUREDIDENTITY = #insuredidentity:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="startdate" >
        STARTDATE = #startdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="starthour" >
        STARTHOUR = #starthour:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="enddate" >
        ENDDATE = #enddate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="ta00ta0d" >
        TA00TA0D = #ta00ta0d:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="ta01ta0e" >
        TA01TA0E = #ta01ta0e:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tr45" >
        TR45 = #tr45:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="insuredtotaldays" >
        INSUREDTOTALDAYS = #insuredtotaldays:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="sumpremium" >
        SUMPREMIUM = #sumpremium:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="travelpalce" >
        TRAVELPALCE = #travelpalce:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="underwriteenddate" >
        UNDERWRITEENDDATE = #underwriteenddate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="benefitInsuredname" >
        BENEFIT_INSUREDNAME = #benefitInsuredname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="benefitInsuredidentity" >
        BENEFIT_INSUREDIDENTITY = #benefitInsuredidentity:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="totalinsuredno" >
        TOTALINSUREDNO = #totalinsuredno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="handleridentifynumber" >
        HANDLERIDENTIFYNUMBER = #handleridentifynumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="channelcode" >
        CHANNELCODE = #channelcode:VARCHAR#
      </isNotNull>
   </dynamic>
    where OID = #oid:DECIMAL#
  </update>
 
</sqlMap>
