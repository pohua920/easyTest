<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="HasAgtLawPol">

  <resultMap id="BaseResultMap" class="com.tlg.prpins.entity.HasAgtLawPol">
    <result column="OID" property="oid" jdbcType="DECIMAL" />
    <result column="BATCH_NO" property="batchNo" jdbcType="VARCHAR" />
    <result column="PROPOSALNO" property="proposalno" jdbcType="VARCHAR" />
    <result column="POLICYNO" property="policyno" jdbcType="VARCHAR" />
    <result column="AGENTCODE" property="agentcode" jdbcType="VARCHAR" />
    <result column="HANDLERIDENTIFYNUMBER" property="handleridentifynumber" jdbcType="VARCHAR" />
    <result column="RISKCNAME" property="riskcname" jdbcType="VARCHAR" />
    <result column="APPLINAME" property="appliname" jdbcType="VARCHAR" />
    <result column="BIRTHDAY" property="birthday" jdbcType="VARCHAR" />
    <result column="APPLICODE" property="applicode" jdbcType="VARCHAR" />
    <result column="STARTDATE" property="startdate" jdbcType="VARCHAR" />
    <result column="STARTHOUR" property="starthour" jdbcType="VARCHAR" />
    <result column="ENDDATE" property="enddate" jdbcType="VARCHAR" />
    <result column="ENDHOUR" property="endhour" jdbcType="VARCHAR" />
    <result column="INSUREDTOTALDAYS" property="insuredtotaldays" jdbcType="DECIMAL" />
    <result column="TOTALINSUREDNO" property="totalinsuredno" jdbcType="VARCHAR" />
    <result column="SUMPREMIUM" property="sumpremium" jdbcType="DECIMAL" />
    <result column="TRAVELPALCE" property="travelpalce" jdbcType="VARCHAR" />
    <result column="ROOMTELENUMBER" property="roomtelenumber" jdbcType="VARCHAR" />
    <result column="ROOMPOSTCODE" property="roompostcode" jdbcType="VARCHAR" />
    <result column="ROOMADDRESS" property="roomaddress" jdbcType="VARCHAR" />
    <result column="UNDERWRITEENDDATE" property="underwriteenddate" jdbcType="VARCHAR" />
    <result column="RISKCODE" property="riskcode" jdbcType="VARCHAR" />
    <result column="CAR_LICENSENO" property="carLicenseno" jdbcType="VARCHAR" />
    <result column="PE_SPECIES" property="peSpecies" jdbcType="VARCHAR" />
    <result column="PE_IDENTIFYNUMBER" property="peIdentifynumber" jdbcType="VARCHAR" />
    <result column="PA_JOBTITLE" property="paJobtitle" jdbcType="VARCHAR" />
  </resultMap>

  <!-- mantis：OTH0182，處理人員：DP0714，錠嵂非專案回饋檔新增業務來源和商品 -->
  <select id="selectForGenFile" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select * from HAS_AGT_LAW_POL OP
      join HAS_AGT_BATCH_DTL DTL on OP.BATCH_NO = DTL.BATCH_NO and OP.policyno = DTL.CORE_NO
     where OP.BATCH_NO = #batchNo#
       and DTL.BUSINESSNATURE = #businessNature#
       and DTL.ORDERSEQ_STATUS IN ('01','02')
     order by OP.policyno
  </select>

  <select id="selectByParams" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select * from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL
    <dynamic prepend="WHERE">
    	<isNotEmpty prepend="AND" property="oid">
		OID = #oid:DECIMAL#
		</isNotEmpty>
      <isNotNull prepend="AND" property="batchNo">
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="riskcode">
        RISKCODE = #riskcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="policyno">
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
    </dynamic>
    <isNotEmpty property="sortBy">
		ORDER BY $sortBy$ $sortType$ 
	</isNotEmpty>
  </select>

  <select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map" >
    <include refid="Utils.sql1" />
    select * from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL
    <dynamic prepend="WHERE" >
      <isNotEmpty prepend="AND" property="oid">
		OID = #oid:DECIMAL#
		</isNotEmpty>
      <isNotNull prepend="AND" property="batchNo">
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="riskcode">
        RISKCODE = #riskcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="policyno">
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
      <include refid="Utils.sql2" />
    </dynamic>
  </select>

  <select id="selectByUK" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select * from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL
    where OID = #oid:DECIMAL#
  </select>

  <select id="count" parameterClass="java.util.Map" resultClass="java.lang.Integer">
    select count(*) from <include refid="Utils.prpinsSchema"/>HAS_AGT_LAW_POL
    <dynamic prepend="WHERE">
      <isNotNull prepend="AND" property="batchNo">
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="riskcode">
        RISKCODE = #riskcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="AND" property="policyno">
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
    </dynamic>
  </select>

  <insert id="insert" parameterClass="com.tlg.prpins.entity.HasAgtLawPol" >
    insert into HAS_AGT_LAW_POL (OID, BATCH_NO, PROPOSALNO, POLICYNO,
      AGENTCODE, HANDLERIDENTIFYNUMBER, RISKCNAME, APPLINAME, BIRTHDAY,
      APPLICODE, STARTDATE, STARTHOUR, ENDDATE, ENDHOUR,
      INSUREDTOTALDAYS, TOTALINSUREDNO, SUMPREMIUM, TRAVELPALCE, ROOMTELENUMBER,
      ROOMPOSTCODE, ROOMADDRESS, UNDERWRITEENDDATE, RISKCODE, CAR_LICENSENO,
      PE_SPECIES, PE_IDENTIFYNUMBER, PA_JOBTITLE)
    values (#oid:DECIMAL#, #batchNo:VARCHAR#, #proposalno:VARCHAR#, #policyno:VARCHAR#,
      #agentcode:VARCHAR#, #handleridentifynumber:VARCHAR#, #riskcname:VARCHAR#, #appliname:VARCHAR#, #birthday:VARCHAR#,
      #applicode:VARCHAR#, #startdate:VARCHAR#, #starthour:VARCHAR#, #enddate:VARCHAR#, #endhour:VARCHAR#,
      #insuredtotaldays:DECIMAL#, #totalinsuredno:VARCHAR#, #sumpremium:DECIMAL# #travelpalce:VARCHAR#, #roomtelenumber:VARCHAR#,
      #roompostcode:VARCHAR#, #roomaddress:VARCHAR#, #underwriteenddate:VARCHAR#, #riskcode:VARCHAR#, #carLicenseno:VARCHAR#,
      #peSpecies:VARCHAR#, #peIdentifynumber:VARCHAR#, #paJobtitle:VARCHAR#)
  </insert>
 
  <update id="update" parameterClass="com.tlg.prpins.entity.HasAgtLawPol" >
    update HAS_AGT_LAW_POL
    <dynamic prepend="set" >
      <isNotNull prepend="," property="batchNo">
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="proposalno">
        PROPOSALNO = #proposalno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="policyno">
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="agentcode">
        AGENTCODE = #agentcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="handleridentifynumber">
        HANDLERIDENTIFYNUMBER = #handleridentifynumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="riskcname">
        RISKCNAME = #riskcname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="appliname">
        APPLINAME = #appliname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="birthday">
        BIRTHDAY = #birthday:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="applicode">
        APPLICODE = #applicode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="startdate">
        STARTDATE = #startdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="starthour">
        STARTHOUR = #starthour:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="enddate">
        ENDDATE = #enddate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="endhour">
        ENDHOUR = #endhour:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="totalinsuredno">
        TOTALINSUREDNO = #totalinsuredno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="sumpremium">
        SUMPREMIUM = #sumpremium:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="travelpalce">
        TRAVELPALCE = #travelpalce:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="roomtelenumber">
        ROOMTELENUMBER = #roomtelenumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="roompostcode">
        ROOMPOSTCODE = #roompostcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="roomaddress">
        ROOMADDRESS = #roomaddress:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="underwriteenddate">
        UNDERWRITEENDDATE = #underwriteenddate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="riskcode">
        RISKCODE = #riskcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="carLicenseno">
        CAR_LICENSENO = #carLicenseno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="peSpecies">
        PE_SPECIES = #peSpecies:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="peIdentifynumber">
        PE_IDENTIFYNUMBER = #peIdentifynumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="paJobtitle">
        PA_JOBTITLE = #paJobtitle:VARCHAR#
      </isNotNull>
    </dynamic>
    where OID = #oid:DECIMAL#
  </update>
 
</sqlMap>
