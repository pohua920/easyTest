<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="FirCtbcRst" >
  <resultMap id="BaseResultMap" class="com.tlg.prpins.entity.FirCtbcRst" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Apr 14 09:51:05 CST 2020.
    -->
    <result column="OID" property="oid" jdbcType="DECIMAL" />
    <result column="BATCH_NO" property="batchNo" jdbcType="VARCHAR" />
    <result column="RST_TYPE" property="rstType" jdbcType="VARCHAR" />
    <result column="FK_ORDER_SEQ" property="fkOrderSeq" jdbcType="VARCHAR" />
    <result column="INSCO_STATUS" property="inscoStatus" jdbcType="VARCHAR" />
    <result column="INSCO_FEEDBACK" property="inscoFeedback" jdbcType="VARCHAR" />
    <result column="POLICYNO" property="policyno" jdbcType="VARCHAR" />
    <result column="FILENAME_CTF" property="filenameCtf" jdbcType="VARCHAR" />
    <result column="O_BATCH_NO" property="oBatchNo" jdbcType="VARCHAR" />
    <result column="O_BATCH_SEQ" property="oBatchSeq" jdbcType="VARCHAR" />
    <!-- mantis：FIR0181， 中信新件流程-排程查詢作業(含產生查詢及回饋查詢)-->
    <result column="FILENAME_RST" property="filenameRst" jdbcType="VARCHAR" />
    <result column="ICREATE" property="icreate" jdbcType="VARCHAR" />
    <result column="DCREATE" property="dcreate" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <!-- mantis：FIR0181， 中信新件流程-排程查詢作業(含產生查詢及回饋查詢) start-->
  <resultMap class="com.tlg.aps.vo.Aps003DetailVo" id="aps003DetailVoResultMap">
    <result column="BATCH_NO" jdbcType="VARCHAR" property="batchNo" />
    <result column="RST_TYPE" property="rstType" jdbcType="VARCHAR" />
    <result column="FK_ORDER_SEQ" jdbcType="VARCHAR" property="fkOrderSeq" />
    <result column="INSCO_STATUS" property="inscoStatus" jdbcType="VARCHAR" />
    <result column="INSCO_FEEDBACK" property="inscoFeedback" jdbcType="VARCHAR" />
    <result column="POLICYNO" property="policyno" jdbcType="VARCHAR" />
    <result column="DCREATE" property="dcreate" jdbcType="TIMESTAMP" />
    <result column="COMCODE" property="comcode" jdbcType="VARCHAR" />
    <result column="HANDLER1CODE" property="handler1code" jdbcType="VARCHAR" />
  </resultMap>
  <!-- mantis：FIR0181， 中信新件流程-排程查詢作業(含產生查詢及回饋查詢) end-->
  
  <select id="count" parameterClass="java.util.Map" resultClass="java.lang.Integer">

    select count(1) from <include refid="Utils.prpinsSchema"/>FIR_CTBC_RST
    <dynamic prepend="WHERE">
    	<isNotEmpty prepend="AND" property="batchNo">
			BATCH_NO = #batchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="oBatchNo">
			O_BATCH_NO = #oBatchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="oBatchSeq">
			O_BATCH_SEQ = #oBatchSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="fkOrderSeq">
			FK_ORDER_SEQ = #fkOrderSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="filenameZip">
			FILENAME_RST = #filenameRst#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rstType">
			RST_TYPE = #rstType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policyno">
			POLICYNO = #policyno#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="startCreateDate">
			DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="endCreateDate">
			DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
	</dynamic>
	
  </select>
  
  <!-- mantis：FIR0181， 中信新件流程-排程查詢作業(含產生查詢及回饋查詢) start-->
  <select id="countForAps003" parameterClass="java.util.Map" resultClass="java.lang.Integer">

    select count(1) from <include refid="Utils.prpinsSchema"/>FIR_CTBC_RST RST
    LEFT JOIN PRPCMAIN PM ON RST.POLICYNO = PM.POLICYNO
    <dynamic prepend="WHERE">
    	<isNotEmpty prepend="AND" property="batchNo">
			RST.BATCH_NO = #batchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="oBatchNo">
			RST.O_BATCH_NO = #oBatchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="oBatchSeq">
			RST.O_BATCH_SEQ = #oBatchSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="fkOrderSeq">
			RST.FK_ORDER_SEQ = #fkOrderSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="filenameZip">
			RST.FILENAME_RST = #filenameRst#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rstType">
			RST.RST_TYPE = #rstType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policyno">
			RST.POLICYNO = #policyno#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="startCreateDate">
			RST.DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="endCreateDate">
			RST.DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="comcode">
			PM.COMCODE = #comcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="handler1code">
			PM.HANDLER1CODE = #handler1code#
		</isNotEmpty>
	</dynamic>
	
  </select>
  <!-- mantis：FIR0181， 中信新件流程-排程查詢作業(含產生查詢及回饋查詢) end-->
  
  <select id="selectByParams" parameterClass="java.util.Map" resultMap="BaseResultMap">

	select * from <include refid="Utils.prpinsSchema"/>FIR_CTBC_RST
    <dynamic prepend="WHERE">
    	<isNotEmpty prepend="AND" property="batchNo">
			BATCH_NO = #batchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="oBatchNo">
			O_BATCH_NO = #oBatchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="oBatchSeq">
			O_BATCH_SEQ = #oBatchSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="fkOrderSeq">
			FK_ORDER_SEQ = #fkOrderSeq#
		</isNotEmpty>
	</dynamic>
  </select>
  
  <select id="select" parameterClass="java.util.Map" resultMap="BaseResultMap">
  	<include refid="Utils.sql1"/>
	 select * from <include refid="Utils.prpinsSchema"/>FIR_CTBC_RST
    <dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="batchNo">
				BATCH_NO = #batchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="filenameZip">
				FILENAME_RST = #filenameRst#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="rstType">
				RST_TYPE = #rstType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="fkOrderSeq">
				FK_ORDER_SEQ = #fkOrderSeq#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="policyno">
				POLICYNO = #policyno#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startCreateDate">
				DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endCreateDate">
				DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
    </dynamic>
    <isNotEmpty property="sotrBy">
		ORDER BY $sortBy$ $sortType$ 
	</isNotEmpty>
    <include refid="Utils.sql2"/>
  </select>
  
  <select id="selectForAps003" parameterClass="java.util.Map" resultMap="aps003DetailVoResultMap">
  	<include refid="Utils.sql1"/>
	 select RST.BATCH_NO, RST.DCREATE, RST.FK_ORDER_SEQ,RST.RST_TYPE,RST.INSCO_STATUS,
	 	RST.INSCO_FEEDBACK, RST.POLICYNO, RST.FILENAME_RST,
		PM.COMCODE,PM.HANDLER1CODE
	 from <include refid="Utils.prpinsSchema"/>FIR_CTBC_RST RST
	 LEFT JOIN PRPCMAIN PM ON RST.POLICYNO = PM.POLICYNO
    <dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="batchNo">
				RST.BATCH_NO = #batchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="filenameZip">
				RST.FILENAME_RST = #filenameRst#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="rstType">
				RST.RST_TYPE = #rstType#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="fkOrderSeq">
				RST.FK_ORDER_SEQ = #fkOrderSeq#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="policyno">
				RST.POLICYNO = #policyno#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startCreateDate">
				RST.DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endCreateDate">
				RST.DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="comcode">
				PM.COMCODE = #comcode#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1code">
				PM.HANDLER1CODE = #handler1code#
			</isNotEmpty>
    </dynamic>
    <isNotEmpty property="sotrBy">
		ORDER BY $sortBy$ $sortType$ 
	</isNotEmpty>
    <include refid="Utils.sql2"/>
  </select>

  <select id="selectByPK" resultMap="BaseResultMap" parameterClass="com.tlg.prpins.entity.FirCtbcRst" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Apr 14 09:51:05 CST 2020.
    -->
    select OID, BATCH_NO, RST_TYPE, FK_ORDER_SEQ, INSCO_STATUS, INSCO_FEEDBACK, POLICYNO,
      FILENAME_CTF, O_BATCH_NO, O_BATCH_SEQ, ICREATE, DCREATE
    from FIR_CTBC_RST
    where OID = #oid:DECIMAL#
  </select>
  <delete id="delete" parameterClass="com.tlg.prpins.entity.FirCtbcRst" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Apr 14 09:51:05 CST 2020.
    -->
    delete from FIR_CTBC_RST
    where OID = #oid:DECIMAL#
  </delete>

  <insert id="insert" parameterClass="com.tlg.prpins.entity.FirCtbcRst" >
    <selectKey resultClass="java.math.BigDecimal" keyProperty="oid" >    
		SELECT FIR_CTBC_RST_SEQ.NEXTVAL AS OID FROM DUAL    
	</selectKey>
    
    insert into FIR_CTBC_RST (OID, BATCH_NO, RST_TYPE, FK_ORDER_SEQ, INSCO_STATUS, INSCO_FEEDBACK,
      POLICYNO, FILENAME_CTF, O_BATCH_NO, O_BATCH_SEQ, ICREATE, DCREATE)
    values (#oid:DECIMAL#, #batchNo:VARCHAR#, #rstType:VARCHAR#, #fkOrderSeq:VARCHAR#,
      #inscoStatus:VARCHAR#, #inscoFeedback:VARCHAR#, #policyno:VARCHAR#, #filenameCtf:VARCHAR#,
      #oBatchNo:VARCHAR#, #oBatchSeq:VARCHAR#, #icreate:VARCHAR#, #dcreate:TIMESTAMP#)
  </insert>

  <update id="update" parameterClass="com.tlg.prpins.entity.FirCtbcRst" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Apr 14 09:51:05 CST 2020.
    -->
    update FIR_CTBC_RST
    <dynamic prepend="set" >
      <isNotNull prepend="," property="batchNo" >
        BATCH_NO = #batchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rstType" >
        RST_TYPE = #rstType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="fkOrderSeq" >
        FK_ORDER_SEQ = #fkOrderSeq:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="inscoStatus" >
        INSCO_STATUS = #inscoStatus:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="inscoFeedback" >
        INSCO_FEEDBACK = #inscoFeedback:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="policyno" >
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="filenameCtf" >
        FILENAME_CTF = #filenameCtf:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="oBatchNo" >
        O_BATCH_NO = #oBatchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="oBatchSeq" >
        O_BATCH_SEQ = #oBatchSeq:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="icreate" >
        ICREATE = #icreate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dcreate" >
        DCREATE = #dcreate:TIMESTAMP#
      </isNotNull>
    </dynamic>
    where OID = #oid:DECIMAL#
  </update>
 
</sqlMap>