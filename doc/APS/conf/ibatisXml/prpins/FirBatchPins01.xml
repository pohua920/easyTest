<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<!-- mantis：FIR0427，處理人員：BJ085，需求單編號：FIR0427 個人險-保單通訊資料產生及下載作業 -->
<sqlMap namespace="FirBatchPins01" >
  <resultMap id="BaseResultMap" class="com.tlg.prpins.entity.FirBatchPins01" >
    <result column="BNO" property="bno" jdbcType="VARCHAR" />
    <result column="PARAMSTARTDATE" property="paramstartdate" jdbcType="TIMESTAMP" />
    <result column="PARAMENDDATE" property="paramenddate" jdbcType="TIMESTAMP" />
    <result column="PARAMBASEDATE" property="parambasedate" jdbcType="TIMESTAMP" />
    <result column="PARAMRISKCODE" property="paramriskcode" jdbcType="VARCHAR" />
    <result column="DATASTATUS" property="datastatus" jdbcType="VARCHAR" />
    <result column="DATACOUNT" property="datacount" jdbcType="DECIMAL" />
    <result column="ICREATE" property="icreate" jdbcType="VARCHAR" />
    <result column="DCREATE" property="dcreate" jdbcType="TIMESTAMP" />
    <result column="IUPDATE" property="iupdate" jdbcType="VARCHAR" />
    <result column="DUPDATE" property="dupdate" jdbcType="TIMESTAMP" />
    <result column="ISVOID" property="isvoid" jdbcType="VARCHAR" />
    <result column="DDOWNLOAD" property="ddownload" jdbcType="TIMESTAMP" />
    <result column="IDOWNLOAD" property="idownload" jdbcType="VARCHAR" />
    <result column="DDATASTART" property="ddatastart" jdbcType="TIMESTAMP" />
    <result column="DDATAEND" property="ddataend" jdbcType="TIMESTAMP" />
    <result column="DFILESTART" property="dfilestart" jdbcType="TIMESTAMP" />
    <result column="DFILEEND" property="dfileend" jdbcType="TIMESTAMP" />
    <result column="RISKCODELOG" property="riskcodelog" jdbcType="VARCHAR" />
    <result column="UPLOADOID" property="uploadoid" jdbcType="VARCHAR" />
    <result column="FIR_BATCH_LOG_BNO" property="firBatchLogBno" jdbcType="VARCHAR" />
    <result column="UPLOADOIDERRMES" property="uploadoiderrmes" jdbcType="VARCHAR" />
  </resultMap>

  <select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
		<include refid="Utils.sql1" />
			SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_BATCH_PINS01
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="bno">
				BNO = #bno#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="datastatus">
				DATASTATUS = #datastatus#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate">
				DDATASTART <![CDATA[>=]]> to_date(#startDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				DDATASTART <![CDATA[<=]]> to_date(#endDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
		</dynamic>
		<include refid="Utils.sql2" />
  </select>

  <select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*) FROM <include refid="Utils.prpinsSchema"/>FIR_BATCH_PINS01
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="bno">
				BNO = #bno#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="datastatus">
				DATASTATUS = #datastatus#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate">
				DDATASTART <![CDATA[>=]]> to_date(#startDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				DDATASTART <![CDATA[<=]]> to_date(#endDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
		</dynamic>
  </select>
  
  <select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
		SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_BATCH_PINS01
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="ddatastart">
				DDATASTART = #ddatastart#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="bno">
				BNO = #bno#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="datastatus">
				DATASTATUS = #datastatus#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="datastatusEqual">
				DATASTATUS <![CDATA[<>]]> #datastatusEqual#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="isvoid">
				ISVOID = #isvoid#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="firBatchLogBno">
				FIR_BATCH_LOG_BNO = #firBatchLogBno#
			</isNotEmpty>
		</dynamic>
  </select>
  
  <select id="selectByUK" resultMap="BaseResultMap" parameterClass="java.util.Map">
		SELECT * FROM FIR_BATCH_PINS01
		WHERE BNO = #bno:VARCHAR#
  </select>
  
  <delete id="delete" parameterClass="com.tlg.prpins.entity.FirBatchPins01" >
    delete from FIR_BATCH_PINS01
    where BNO = #bno:VARCHAR#
  </delete>
  
  <insert id="insert" parameterClass="com.tlg.prpins.entity.FirBatchPins01" >
    insert into FIR_BATCH_PINS01 (BNO, PARAMSTARTDATE, PARAMENDDATE, PARAMBASEDATE, PARAMRISKCODE,
      DATASTATUS, DATACOUNT, ICREATE, DCREATE, IUPDATE, DUPDATE, ISVOID, DDOWNLOAD, IDOWNLOAD,
      DDATASTART, DDATAEND, DFILESTART, DFILEEND, RISKCODELOG, UPLOADOID, FIR_BATCH_LOG_BNO,
      UPLOADOIDERRMES)
    values (#bno:VARCHAR#, #paramstartdate:TIMESTAMP#, #paramenddate:TIMESTAMP#,
      #parambasedate:TIMESTAMP#, #paramriskcode:VARCHAR#, #datastatus:VARCHAR#, #datacount:DECIMAL#,
      #icreate:VARCHAR#, #dcreate:TIMESTAMP#, #iupdate:VARCHAR#, #dupdate:TIMESTAMP#,
      #isvoid:VARCHAR#, #ddownload:TIMESTAMP#, #idownload:VARCHAR#, #ddatastart:TIMESTAMP#,
      #ddataend:TIMESTAMP#, #dfilestart:TIMESTAMP#, #dfileend:TIMESTAMP#, #riskcodelog:VARCHAR#,
      #uploadoid:VARCHAR#, #firBatchLogBno:VARCHAR#, #uploadoiderrmes:VARCHAR#)
  </insert>
  
  <update id="update" parameterClass="com.tlg.prpins.entity.FirBatchPins01" >
    update FIR_BATCH_PINS01
    <dynamic prepend="set" >
      <isNotNull prepend="," property="paramstartdate" >
        PARAMSTARTDATE = #paramstartdate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="paramenddate" >
        PARAMENDDATE = #paramenddate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="parambasedate" >
        PARAMBASEDATE = #parambasedate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="paramriskcode" >
        PARAMRISKCODE = #paramriskcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="datastatus" >
        DATASTATUS = #datastatus:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="datacount" >
        DATACOUNT = #datacount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="icreate" >
        ICREATE = #icreate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dcreate" >
        DCREATE = #dcreate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="iupdate" >
        IUPDATE = #iupdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dupdate" >
        DUPDATE = #dupdate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="isvoid" >
        ISVOID = #isvoid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="ddownload" >
        DDOWNLOAD = #ddownload:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="idownload" >
        IDOWNLOAD = #idownload:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="ddatastart" >
        DDATASTART = #ddatastart:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="ddataend" >
        DDATAEND = #ddataend:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="dfilestart" >
        DFILESTART = #dfilestart:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="dfileend" >
        DFILEEND = #dfileend:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="riskcodelog" >
        RISKCODELOG = #riskcodelog:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="uploadoid" >
        UPLOADOID = #uploadoid:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="firBatchLogBno" >
        FIR_BATCH_LOG_BNO = #firBatchLogBno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="uploadoiderrmes" >
        UPLOADOIDERRMES = #uploadoiderrmes:VARCHAR#
      </isNotNull>
    </dynamic>
    where BNO = #bno:VARCHAR#
  </update>
</sqlMap>