<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<!-- mantis：FIR0571，處理人員：BJ085，需求單編號：FIR0571 住火_APS到期通知處理作業-新增印刷廠產檔作業規格-->
<sqlMap namespace="FirRenewPhone" >
  <resultMap id="BaseResultMap" class="com.tlg.prpins.entity.FirRenewPhone" >
    <result column="P_NO" property="pNo" jdbcType="VARCHAR" />
    <result column="P_TYPE" property="pType" jdbcType="VARCHAR" />
    <result column="P_NAME" property="pName" jdbcType="VARCHAR" />
    <result column="P_PHONE" property="pPhone" jdbcType="VARCHAR" />
    <result column="ICREATE" property="icreate" jdbcType="VARCHAR" />
    <result column="DCREATE" property="dcreate" jdbcType="TIMESTAMP" />
    <result column="IUPDATE" property="iupdate" jdbcType="VARCHAR" />
    <result column="DUPDATE" property="dupdate" jdbcType="TIMESTAMP" />
  </resultMap>

  <select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
	<include refid="Utils.sql1" />
		SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_RENEW_PHONE
		<dynamic prepend="WHERE">
		  <isNotEmpty prepend="AND" property="pNo">
			P_NO = #pNo#
	      </isNotEmpty>
	      <isNotEmpty prepend="AND" property="pType">
	        P_TYPE = #pType#
	      </isNotEmpty>
		</dynamic>
	<include refid="Utils.sql2" />
  </select>

  <select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
	 SELECT COUNT(*) FROM <include refid="Utils.prpinsSchema"/>FIR_RENEW_PHONE
		<dynamic prepend="WHERE">
		  <isNotEmpty prepend="AND" property="pNo">
			P_NO = #pNo#
	      </isNotEmpty>
	      <isNotEmpty prepend="AND" property="pType">
	        P_TYPE = #pType#
	      </isNotEmpty>
		</dynamic>
  </select>

  <select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
	SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_RENEW_PHONE
		<dynamic prepend="WHERE">
		  <isNotEmpty prepend="AND" property="pNo">
			P_NO = #pNo#
	      </isNotEmpty>
	      <isNotEmpty prepend="AND" property="pType">
	        P_TYPE = #pType#
	      </isNotEmpty>
		</dynamic>
  </select>

  <select id="selectByUK" resultMap="BaseResultMap" parameterClass="java.util.Map">
	SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_RENEW_PHONE
	 where P_NO = #pNo:VARCHAR#
     and P_TYPE = #pType:VARCHAR#
  </select>

  <delete id="delete" parameterClass="com.tlg.prpins.entity.FirRenewPhone" >
    delete from <include refid="Utils.prpinsSchema"/>FIR_RENEW_PHONE
    where P_NO = #pNo:VARCHAR#
      and P_TYPE = #pType:VARCHAR#
  </delete>

  <insert id="insert" parameterClass="com.tlg.prpins.entity.FirRenewPhone" >
    insert into <include refid="Utils.prpinsSchema"/>FIR_RENEW_PHONE 
      (P_NO, P_TYPE, P_NAME, P_PHONE, ICREATE, DCREATE, IUPDATE, DUPDATE)
    values (#pNo:VARCHAR#, #pType:VARCHAR#, #pName:VARCHAR#, #pPhone:VARCHAR#, #icreate:VARCHAR#,
      #dcreate:TIMESTAMP#, #iupdate:VARCHAR#, #dupdate:TIMESTAMP#)
  </insert>

  <update id="update" parameterClass="com.tlg.prpins.entity.FirRenewPhone" >
    update <include refid="Utils.prpinsSchema"/>FIR_RENEW_PHONE
    <dynamic prepend="set" >
      <isNotNull prepend="," property="pName" >
        P_NAME = #pName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="pPhone" >
        P_PHONE = #pPhone:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="icreate" >
        ICREATE = #icreate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dcreate" >
        DCREATE = #dcreate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="iupdate" >
        IUPDATE = #iupdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dupdate" >
        DUPDATE = #dupdate:TIMESTAMP#
      </isNotNull>
    </dynamic>
    where P_NO = #pNo:VARCHAR#
      and P_TYPE = #pType:VARCHAR#
  </update>
  
  <resultMap id="pHoneMap" class="com.tlg.prpins.entity.FirRenewPhone" >
    <result column="P_PHONE" property="pPhone" jdbcType="VARCHAR" />
  </resultMap>
  
  <select id="selectPhoneByHandler1code" resultMap="pHoneMap" parameterClass="java.util.Map">
	SELECT FRP.P_PHONE FROM FIR_RENEW_PHONE FRP
	LEFT JOIN PRPDUSER PU ON FRP.P_NO = PU.COMCODE AND P_TYPE = #pType#
	WHERE PU.USERCODE = #usercode#
  </select>
  
</sqlMap>