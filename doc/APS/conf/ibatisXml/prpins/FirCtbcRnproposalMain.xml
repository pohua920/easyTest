<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<!-- mantis：FIR0459，處理人員：CC009，需求單編號：FIR0459 住火-APS中信續件要保書-排程查詢作業 
	 mantis：FIR0458，處理人員：CC009，需求單編號：FIR0458 住火-APS中信續件要保書-資料接收排程 -->
<sqlMap namespace="FirCtbcRnproposalMain" >
  <resultMap id="BaseResultMap" class="com.tlg.prpins.entity.FirCtbcRnproposalMain" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 28 10:12:12 CST 2022.
    -->
    <result column="BATCH_NO" property="batchNo" jdbcType="VARCHAR" />
    <result column="BATCH_SEQ" property="batchSeq" jdbcType="VARCHAR" />
    <result column="FILENAME_ZIP" property="filenameZip" jdbcType="VARCHAR" />
    <result column="DATA_QTY" property="dataQty" jdbcType="DECIMAL" />
    <result column="PDF_QTY" property="pdfQty" jdbcType="DECIMAL" />
    <result column="FILE_STATUS" property="fileStatus" jdbcType="VARCHAR" />
    <result column="DELETE_FLAG" property="deleteFlag" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
    <result column="ICREATE" property="icreate" jdbcType="VARCHAR" />
    <result column="DCREATE" property="dcreate" jdbcType="TIMESTAMP" />
    <result column="IUPDATE" property="iupdate" jdbcType="VARCHAR" />
    <result column="DUPDATE" property="dupdate" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Mar 19 17:18:25 CST 2020.
    -->
    BATCH_NO, BATCH_SEQ, FILENAME_ZIP, DATA_QTY, PDF_QTY, FILE_STATUS, DELETE_FLAG, 
    REMARK, ICREATE, DCREATE, IUPDATE, DUPDATE
  </sql>
  
  <select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*) FROM FIR_CTBC_RNPROPOSAL_MAIN
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="batchNo">
				BATCH_NO = #batchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="batchSeq">
				BATCH_SEQ = #batchSeq#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="filenameZip">
				FILENAME_ZIP = #filenameZip#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="fileStatus">
				FILE_STATUS = #fileStatus#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="deleteFlag">
				DELETE_FLAG = #deleteFlag#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startCreateDate">
				DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		  	</isNotEmpty>
		  	<isNotEmpty prepend="AND" property="endCreateDate">
				DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		  	</isNotEmpty>
		  	<isNotEmpty prepend="AND" property="policyno">
				BATCH_NO || BATCH_SEQ IN ( SELECT DISTINCT BATCH_NO || BATCH_SEQ FROM FIR_CTBC_RNPROPOSAL_DTL WHERE POLICYNO = #policyno#)
			</isNotEmpty>
		</dynamic>
	</select>
	<select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
		<include refid="Utils.sql1" />
			SELECT * FROM FIR_CTBC_RNPROPOSAL_MAIN
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="batchNo">
				BATCH_NO = #batchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="batchSeq">
				BATCH_SEQ = #batchSeq#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="filenameZip">
				FILENAME_ZIP = #filenameZip#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="fileStatus">
				FILE_STATUS = #fileStatus#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startCreateDate">
				DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		  	</isNotEmpty>
		  	<isNotEmpty prepend="AND" property="endCreateDate">
				DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
		  	</isNotEmpty>
		  	<isNotEmpty prepend="AND" property="policyno">
				BATCH_NO || BATCH_SEQ IN ( SELECT DISTINCT BATCH_NO || BATCH_SEQ FROM FIR_CTBC_RNPROPOSAL_DTL WHERE POLICYNO = #policyno#)
			</isNotEmpty>
		</dynamic>
		<include refid="Utils.sql2" />
	</select>
	
	<select id="selectByParams" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select 
    <include refid="FirCtbcRnproposalMain.Base_Column_List" />
    from <include refid="Utils.prpinsSchema"/>FIR_CTBC_RNPROPOSAL_MAIN
    	<dynamic prepend="WHERE">
    		<isNotEmpty prepend="AND" property="batchNo">
				BATCH_NO = #batchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="batchSeq">
				BATCH_SEQ = #batchSeq#
			</isNotEmpty>
			<isNotNull prepend="AND" property="filenameZip" >
        		FILENAME_ZIP = #filenameZip:VARCHAR#
	      </isNotNull>
	      <isNotNull prepend="AND" property="dataQty" >
	        DATA_QTY = #dataQty:DECIMAL#
	      </isNotNull>
	      <isNotNull prepend="AND" property="pdfQty" >
	        PDF_QTY = #pdfQty:DECIMAL#
	      </isNotNull>
	      <isNotNull prepend="AND" property="fileStatus" >
	        FILE_STATUS = #fileStatus:VARCHAR#
	      </isNotNull>
	      <isNotNull prepend="AND" property="deleteFlag" >
	        DELETE_FLAG = #deleteFlag:VARCHAR#
	      </isNotNull>
	      <isNotNull prepend="AND" property="remark" >
	        REMARK = #remark:VARCHAR#
	      </isNotNull>
	      <isNotNull prepend="AND" property="icreate" >
	        ICREATE = #icreate:VARCHAR#
	      </isNotNull>
	      <isNotNull prepend="AND" property="dcreate" >
	        DCREATE = #dcreate:TIMESTAMP#
	      </isNotNull>
	      <isNotNull prepend="AND" property="iupdate" >
	        IUPDATE = #iupdate:VARCHAR#
	      </isNotNull>
	      <isNotNull prepend="AND" property="dupdate" >
	        DUPDATE = #dupdate:TIMESTAMP#
	      </isNotNull>
		</dynamic>
		<isNotEmpty property="sortBy">
			ORDER BY $sortBy$ $sortType$ 
		</isNotEmpty>
  </select>
  
  <delete id="delete" parameterClass="com.tlg.prpins.entity.FirCtbcRnproposalMain" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 28 10:12:12 CST 2022.
    -->
    delete from FIR_CTBC_RNPROPOSAL_MAIN
    where BATCH_NO = #batchNo:VARCHAR#
      and BATCH_SEQ = #batchSeq:VARCHAR#
  </delete>
  <select id="countByUK" resultClass="java.lang.Integer" parameterClass="com.tlg.prpins.entity.FirCtbcRnproposalMain" >
		SELECT COUNT(*) FROM <include refid="Utils.prpinsSchema"/>FIR_CTBC_RNPROPOSAL_MAIN
		where BATCH_NO = #batchNo:VARCHAR#
			and BATCH_SEQ = #batchSeq:VARCHAR#
	</select>
  <insert id="insert" parameterClass="com.tlg.prpins.entity.FirCtbcRnproposalMain" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 28 10:12:12 CST 2022.
    -->
    insert into FIR_CTBC_RNPROPOSAL_MAIN (BATCH_NO, BATCH_SEQ, FILENAME_ZIP, DATA_QTY, PDF_QTY,
      FILE_STATUS, DELETE_FLAG, REMARK, ICREATE, DCREATE, IUPDATE, DUPDATE)
    values (#batchNo:VARCHAR#, #batchSeq:VARCHAR#, #filenameZip:VARCHAR#, #dataQty:DECIMAL#,
      #pdfQty:DECIMAL#, #fileStatus:VARCHAR#, #deleteFlag:VARCHAR#, #remark:VARCHAR#,
      #icreate:VARCHAR#, #dcreate:TIMESTAMP#, #iupdate:VARCHAR#, #dupdate:TIMESTAMP#)
  </insert>
  <update id="update" parameterClass="com.tlg.prpins.entity.FirCtbcRnproposalMain" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Apr 28 10:12:12 CST 2022.
    -->
    update FIR_CTBC_RNPROPOSAL_MAIN
    <dynamic prepend="set" >
      <isNotNull prepend="," property="filenameZip" >
        FILENAME_ZIP = #filenameZip:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dataQty" >
        DATA_QTY = #dataQty:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="pdfQty" >
        PDF_QTY = #pdfQty:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="fileStatus" >
        FILE_STATUS = #fileStatus:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="deleteFlag" >
        DELETE_FLAG = #deleteFlag:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="remark" >
        REMARK = #remark:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="icreate" >
        ICREATE = #icreate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dcreate" >
        DCREATE = #dcreate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="iupdate" >
        IUPDATE = #iupdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dupdate" >
        DUPDATE = #dupdate:TIMESTAMP#
      </isNotNull>
    </dynamic>
    where BATCH_NO = #batchNo:VARCHAR#
      and BATCH_SEQ = #batchSeq:VARCHAR#
  </update>
</sqlMap>