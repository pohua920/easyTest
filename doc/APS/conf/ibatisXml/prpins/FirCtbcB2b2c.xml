<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<!-- mantis：FIR0497，處理人員：BJ085，需求單編號：FIR0497 中信保代網投_新件回饋檔產生排程規格_新增保經代網投 -->
<sqlMap namespace="FirCtbcB2b2c" >
  <resultMap id="BaseResultMap" class="com.tlg.prpins.entity.FirCtbcB2b2c" >
    <result column="BATCH_NO" jdbcType="VARCHAR" property="batchNo" />
    <result column="BATCH_SEQ" jdbcType="VARCHAR" property="batchSeq" />
    <result column="FK_ORDER_SEQ" jdbcType="VARCHAR" property="fkOrderSeq" />
    <result column="POLICYNO" jdbcType="VARCHAR" property="policyno" />
    <result column="ORDER_SEQ_STATUS" jdbcType="VARCHAR" property="orderSeqStatus" />
    <result column="PRINT_CTF_TIME" jdbcType="TIMESTAMP" property="printCtfTime" />
    <result column="SP_BATCH_NO" jdbcType="VARCHAR" property="spBatchNo" />
    <result column="BK_TIME" jdbcType="TIMESTAMP" property="bkTime" />
    <result column="BK_FILENAME" jdbcType="VARCHAR" property="bkFilename" />
    <result column="BK_TYPE" jdbcType="VARCHAR" property="bkType" />
    <result column="PROD_CODE" jdbcType="VARCHAR" property="prodCode" />
    <result column="PLAN_CODE" jdbcType="VARCHAR" property="planCode" />
    <result column="AREA_CODE" jdbcType="VARCHAR" property="areaCode" />
    <result column="OWNER_NAME" jdbcType="VARCHAR" property="ownerName" />
    <result column="DEBIT_TYPE" jdbcType="VARCHAR" property="debitType" />
    <result column="SEND_TYPE" jdbcType="VARCHAR" property="sendType" />
    <result column="SEND_TO_BANK" jdbcType="VARCHAR" property="sendToBank" />
    <result column="RECIPIENT" jdbcType="VARCHAR" property="recipient" />
    <result column="RECIPIENT_ZIP" jdbcType="VARCHAR" property="recipientZip" />
    <result column="RECIPIENT_CITY" jdbcType="VARCHAR" property="recipientCity" />
    <result column="RECIPIENT_COUNTY" jdbcType="VARCHAR" property="recipientCounty" />
    <result column="RECIPIENT_ADDR" jdbcType="VARCHAR" property="recipientAddr" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="ICREATE" jdbcType="VARCHAR" property="icreate" />
    <result column="DCREATE" jdbcType="TIMESTAMP" property="dcreate" />
    <result column="IUPDATE" jdbcType="VARCHAR" property="iupdate" />
    <result column="DUPDATE" jdbcType="TIMESTAMP" property="dupdate" />
  </resultMap>
  
  <!-- mantis：FIR0499，處理人員：BJ085，需求單編號：FIR0499_住火-中信保代網投_進件查詢作業 start-->
  <resultMap id="aps039DtlResultMap" class="com.tlg.aps.vo.Aps039DetailVo" >
    <result column="OID" jdbcType="DECIMAL" property="oid" />
    <result column="BATCH_NO" jdbcType="VARCHAR" property="batchNo" />
    <result column="BATCH_SEQ" jdbcType="VARCHAR" property="batchSeq" />
    <result column="FK_ORDER_SEQ" jdbcType="VARCHAR" property="fkOrderSeq" />
    <result column="POLICYNO" jdbcType="VARCHAR" property="policyno" />
    <result column="ORDER_SEQ_STATUS" jdbcType="VARCHAR" property="orderSeqStatus" />
    <result column="PRINT_CTF_TIME" jdbcType="TIMESTAMP" property="printCtfTime" />
    <result column="SP_BATCH_NO" jdbcType="VARCHAR" property="spBatchNo" />
    <result column="BK_TIME" jdbcType="TIMESTAMP" property="bkTime" />
    <result column="BK_FILENAME" jdbcType="VARCHAR" property="bkFilename" />
    <result column="BK_TYPE" jdbcType="VARCHAR" property="bkType" />
    <result column="PROD_CODE" jdbcType="VARCHAR" property="prodCode" />
    <result column="PLAN_CODE" jdbcType="VARCHAR" property="planCode" />
    <result column="AREA_CODE" jdbcType="VARCHAR" property="areaCode" />
    <result column="OWNER_NAME" jdbcType="VARCHAR" property="ownerName" />
    <result column="DEBIT_TYPE" jdbcType="VARCHAR" property="debitType" />
    <result column="SEND_TYPE" jdbcType="VARCHAR" property="sendType" />
    <result column="SEND_TO_BANK" jdbcType="VARCHAR" property="sendToBank" />
    <result column="RECIPIENT" jdbcType="VARCHAR" property="recipient" />
    <result column="RECIPIENT_ZIP" jdbcType="VARCHAR" property="recipientZip" />
    <result column="RECIPIENT_CITY" jdbcType="VARCHAR" property="recipientCity" />
    <result column="RECIPIENT_COUNTY" jdbcType="VARCHAR" property="recipientCounty" />
    <result column="RECIPIENT_ADDR" jdbcType="VARCHAR" property="recipientAddr" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="ICREATE" jdbcType="VARCHAR" property="icreate" />
    <result column="DCREATE" jdbcType="TIMESTAMP" property="dcreate" />
    <result column="IUPDATE" jdbcType="VARCHAR" property="iupdate" />
    <result column="DUPDATE" jdbcType="TIMESTAMP" property="dupdate" />
  </resultMap>
  <!-- mantis：FIR0499，處理人員：BJ085，需求單編號：FIR0499_住火-中信保代網投_進件查詢作業 end-->
  
  <select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
	<include refid="Utils.sql1" />
	SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_CTBC_B2B2C
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="batchNo">
			BATCH_NO = #batchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="fkOrderSeq">
			FK_ORDER_SEQ = #fkOrderSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policyno">
			POLICYNO = #policyno#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="ownerName">
			OWNER_NAME = #ownerName#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="areaCode">
			AREA_CODE = #areaCode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="orderSeqStatus">
			ORDER_SEQ_STATUS = #orderSeqStatus#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="debitType">
			DEBIT_TYPE = #debitType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sendType">
			SEND_TYPE = #sendType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sendToBank">
			SEND_TO_BANK = #sendToBank#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="startCreateDate">
			DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
	  	</isNotEmpty>
	  	<isNotEmpty prepend="AND" property="endCreateDate">
			DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
	  	</isNotEmpty>
	  	<!-- mantis：FIR0499，處理人員：BJ085，需求單編號：FIR0499_住火-中信保代網投_進件查詢作業_付款失敗產生回饋檔 -->
	  	<isNotEmpty prepend="AND" property="bkType">
			BK_TYPE = #bkType#
		</isNotEmpty>
	</dynamic>
	<include refid="Utils.sql2" />
  </select>

  <select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
	SELECT COUNT(*) FROM <include refid="Utils.prpinsSchema"/>FIR_CTBC_B2B2C
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="batchNo">
			BATCH_NO = #batchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="fkOrderSeq">
			FK_ORDER_SEQ = #fkOrderSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policyno">
			POLICYNO = #policyno#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="ownerName">
			OWNER_NAME = #ownerName#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="areaCode">
			AREA_CODE = #areaCode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="orderSeqStatus">
			ORDER_SEQ_STATUS = #orderSeqStatus#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="debitType">
			DEBIT_TYPE = #debitType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sendType">
			SEND_TYPE = #sendType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sendToBank">
			SEND_TO_BANK = #sendToBank#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="startCreateDate">
			DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
	  	</isNotEmpty>
	  	<isNotEmpty prepend="AND" property="endCreateDate">
			DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
	  	</isNotEmpty>
	  	<!-- mantis：FIR0499，處理人員：BJ085，需求單編號：FIR0499_住火-中信保代網投_進件查詢作業_付款失敗產生回饋檔 -->
	  	<isNotEmpty prepend="AND" property="bkType">
			BK_TYPE = #bkType#
		</isNotEmpty>
	</dynamic>
  </select>

  <select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
	SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_CTBC_B2B2C
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="batchNo">
			BATCH_NO = #batchNo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="fkOrderSeq">
			FK_ORDER_SEQ = #fkOrderSeq#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policyno">
			POLICYNO = #policyno#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="ownerName">
			OWNER_NAME = #ownerName#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="areaCode">
			AREA_CODE = #areaCode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="orderSeqStatus">
			ORDER_SEQ_STATUS = #orderSeqStatus#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="debitType">
			DEBIT_TYPE = #debitType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sendType">
			SEND_TYPE = #sendType#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sendToBank">
			SEND_TO_BANK = #sendToBank#
		</isNotEmpty>
	</dynamic>
  </select>

  <select id="selectByUK" resultMap="BaseResultMap" parameterClass="java.util.Map">
	SELECT * FROM <include refid="Utils.prpinsSchema"/>FIR_CTBC_B2B2C
	WHERE BATCH_NO = #batchNo:VARCHAR# 
	AND BATCH_SEQ = #batchSeq:VARCHAR# 
	AND FK_ORDER_SEQ = #fkOrderSeq:VARCHAR#
  </select>  
  
  <!-- mantis：FIR0499，處理人員：BJ085，需求單編號：FIR0499_住火-中信保代網投_進件查詢作業 start -->
  <select id="selectForAps039Detail" resultMap="aps039DtlResultMap" parameterClass="java.util.Map">
	SELECT CTF.OID, B2C.*
	FROM FIR_CTBC_B2B2C B2C
	LEFT JOIN FIR_RPT_CTBC_CTF CTF ON B2C.BATCH_NO = CTF.DTL_BATCH_NO 
	AND B2C.BATCH_SEQ = CTF.DTL_BATCH_SEQ AND B2C.SP_BATCH_NO = CTF.RST_BATCH_NO
	WHERE B2C.BATCH_NO = #batchNo:VARCHAR# 
	AND B2C.BATCH_SEQ = #batchSeq:VARCHAR# 
	AND B2C.FK_ORDER_SEQ = #fkOrderSeq:VARCHAR#
  </select>
  <!-- mantis：FIR0499，處理人員：BJ085，需求單編號：FIR0499_住火-中信保代網投_進件查詢作業 end -->
  

  <delete id="deleteByEntity" parameterClass="com.tlg.prpins.entity.FirCtbcB2b2c" >
    delete from <include refid="Utils.prpinsSchema"/>FIR_CTBC_B2B2C
    where BATCH_NO = #batchNo:VARCHAR#
      and BATCH_SEQ = #batchSeq:VARCHAR#
      and FK_ORDER_SEQ = #fkOrderSeq:VARCHAR#
  </delete>

  <insert id="insert" parameterClass="com.tlg.prpins.entity.FirCtbcB2b2c" >
    insert into <include refid="Utils.prpinsSchema"/>FIR_CTBC_B2B2C 
    (BATCH_NO, BATCH_SEQ, FK_ORDER_SEQ, POLICYNO, ORDER_SEQ_STATUS,
      PRINT_CTF_TIME, SP_BATCH_NO, BK_TIME, BK_FILENAME, BK_TYPE, PROD_CODE, PLAN_CODE, AREA_CODE,
      OWNER_NAME, DEBIT_TYPE, SEND_TYPE, SEND_TO_BANK, RECIPIENT, RECIPIENT_ZIP, RECIPIENT_CITY,
      RECIPIENT_COUNTY, RECIPIENT_ADDR, REMARK, ICREATE, DCREATE, IUPDATE, DUPDATE)
    values (#batchNo:VARCHAR#, #batchSeq:VARCHAR#, #fkOrderSeq:VARCHAR#, #policyno:VARCHAR#,
      #orderSeqStatus:VARCHAR#, #printCtfTime:TIMESTAMP#, #spBatchNo:VARCHAR#, #bkTime:TIMESTAMP#,
      #bkFilename:VARCHAR#, #bkType:VARCHAR#, #prodCode:VARCHAR#, #planCode:VARCHAR#,
      #areaCode:VARCHAR#, #ownerName:VARCHAR#, #debitType:VARCHAR#, #sendType:VARCHAR#,
      #sendToBank:VARCHAR#, #recipient:VARCHAR#, #recipientZip:VARCHAR#, #recipientCity:VARCHAR#,
      #recipientCounty:VARCHAR#, #recipientAddr:VARCHAR#, #remark:VARCHAR#, #icreate:VARCHAR#,
      #dcreate:TIMESTAMP#, #iupdate:VARCHAR#, #dupdate:TIMESTAMP#)  
  </insert>

  <update id="update" parameterClass="com.tlg.prpins.entity.FirCtbcB2b2c" >
    update <include refid="Utils.prpinsSchema"/>FIR_CTBC_B2B2C
    <dynamic prepend="set" >
      <isNotNull prepend="," property="policyno" >
        POLICYNO = #policyno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="orderSeqStatus" >
        ORDER_SEQ_STATUS = #orderSeqStatus:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="printCtfTime" >
        PRINT_CTF_TIME = #printCtfTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="spBatchNo" >
        SP_BATCH_NO = #spBatchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bkTime" >
        BK_TIME = #bkTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="bkFilename" >
        BK_FILENAME = #bkFilename:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bkType" >
        BK_TYPE = #bkType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="prodCode">
        PROD_CODE = #prodCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="planCode">
        PLAN_CODE = #planCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="areaCode">
        AREA_CODE = #areaCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="ownerName">
        OWNER_NAME = #ownerName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="debitType">
        DEBIT_TYPE = #debitType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="sendType">
        SEND_TYPE = #sendType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="sendToBank">
        SEND_TO_BANK = #sendToBank:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="recipient">
        RECIPIENT = #recipient:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="recipientZip">
        RECIPIENT_ZIP = #recipientZip:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="recipientCity">
        RECIPIENT_CITY = #recipientCity:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="recipientCounty">
        RECIPIENT_COUNTY = #recipientCounty:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="recipientAddr">
        RECIPIENT_ADDR = #recipientAddr:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="remark">
        REMARK = #remark:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="icreate" >
        ICREATE = #icreate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dcreate" >
        DCREATE = #dcreate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="iupdate" >
        IUPDATE = #iupdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dupdate" >
        DUPDATE = #dupdate:TIMESTAMP#
      </isNotNull>
    </dynamic>
    where BATCH_NO = #batchNo:VARCHAR#
      and BATCH_SEQ = #batchSeq:VARCHAR#
      and FK_ORDER_SEQ = #fkOrderSeq:VARCHAR#
  </update>
</sqlMap>