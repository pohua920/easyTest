<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<!-- mantis：OTH0132，處理人員：BI086，需求單編號：OTH0132  保單存摺AS400資料寫入核心中介Table -->
<sqlMap namespace="Com890wa">

	<resultMap id="BaseResultMap" class="com.tlg.db2.entity.Com890wa" >
	    <result column="WA01" property="wa01" jdbcType="VARCHAR" />
	    <result column="WA02" property="wa02" jdbcType="VARCHAR" />
	    <result column="WA03" property="wa03" jdbcType="VARCHAR" />
	    <result column="WA04" property="wa04" jdbcType="VARCHAR" />
	    <result column="WA05" property="wa05" jdbcType="VARCHAR" />
	    <result column="WA06" property="wa06" jdbcType="VARCHAR" />
	    <result column="WA07" property="wa07" jdbcType="VARCHAR" />
	    <result column="WA08" property="wa08" jdbcType="VARCHAR" />
	    <result column="WA09" property="wa09" jdbcType="VARCHAR" />
	    <result column="WA10" property="wa10" jdbcType="VARCHAR" />
	    <result column="WA11" property="wa11" jdbcType="VARCHAR" />
	    <result column="WA12" property="wa12" jdbcType="VARCHAR" />
	    <result column="WA13" property="wa13" jdbcType="VARCHAR" />
	    <result column="WA14" property="wa14" jdbcType="VARCHAR" />
	    <result column="WA15" property="wa15" jdbcType="VARCHAR" />
	    <result column="WA16" property="wa16" jdbcType="VARCHAR" />
	    <result column="WA17" property="wa17" jdbcType="VARCHAR" />
	    <result column="WA18" property="wa18" jdbcType="VARCHAR" />
	    <result column="WA19" property="wa19" jdbcType="VARCHAR" />
	    <result column="WA20" property="wa20" jdbcType="VARCHAR" />
	    <result column="WA21" property="wa21" jdbcType="VARCHAR" />
	    <result column="WA22" property="wa22" jdbcType="VARCHAR" />
	    <result column="WA23" property="wa23" jdbcType="VARCHAR" />
	    <result column="WA24" property="wa24" jdbcType="VARCHAR" />
	    <result column="WA25" property="wa25" jdbcType="VARCHAR" />
	    <result column="WA26" property="wa26" jdbcType="VARCHAR" />
	    <result column="WA27" property="wa27" jdbcType="VARCHAR" />
	    <result column="WA28" property="wa28" jdbcType="VARCHAR" />
	    <result column="WA29" property="wa29" jdbcType="VARCHAR" />
	    <result column="WA30" property="wa30" jdbcType="VARCHAR" />
	    <result column="WA31" property="wa31" jdbcType="VARCHAR" />
	    <result column="WA32" property="wa32" jdbcType="VARCHAR" />
	    <result column="WA33" property="wa33" jdbcType="VARCHAR" />
	    <result column="WA081" property="wa081" jdbcType="VARCHAR" />
  	</resultMap>

	<select id="selectByUnsend" resultMap="BaseResultMap" parameterClass="java.util.Map">
		SELECT
			STRIP(WA01) AS WA01,
			STRIP(WA02) AS WA02,
			STRIP(WA03) AS WA03,
			STRIP(WA04) AS WA04,
			STRIP(WA05) AS WA05,
			STRIP(WA06) AS WA06,
			STRIP(WA07) AS WA07,
			STRIP(WA08) AS WA08,
			STRIP(WA09) AS WA09,
			STRIP(WA10) AS WA10,
			STRIP(WA11) AS WA11,
			STRIP(WA12) AS WA12,
			STRIP(WA13) AS WA13,
			STRIP(WA14) AS WA14,
			STRIP(WA15) AS WA15,
			STRIP(WA16) AS WA16,
			STRIP(WA17) AS WA17,
			STRIP(WA18) AS WA18,
			STRIP(WA19) AS WA19,
			STRIP(WA20) AS WA20,
			STRIP(WA21) AS WA21,
			STRIP(WA22) AS WA22,
			STRIP(WA23) AS WA23,
			STRIP(WA24) AS WA24,
			STRIP(WA25) AS WA25,
			STRIP(WA26) AS WA26,
			STRIP(WA27) AS WA27,
			STRIP(WA28) AS WA28,
			STRIP(WA29) AS WA29,
			STRIP(WA30) AS WA30,
			STRIP(WA31) AS WA31,
			STRIP(WA32) AS WA32,
			STRIP(WA33) AS WA33,
			STRIP(WA081) AS WA081
		FROM <include refid="Utils.db2CommData"/>COM890WA
		WHERE STRIP(WA24) = ''
		AND STRIP(WA29) = ''
		ORDER BY STRIP(WA04),STRIP(WA28),STRIP(WA081)
		FETCH FIRST 500 ROW ONLY
	</select>

	<select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
		<include refid="Utils.sql1" />
			SELECT STRIP(WA01) AS WA01,
				STRIP(WA02) AS WA02,
				STRIP(WA03) AS WA03,
				STRIP(WA04) AS WA04,
				STRIP(WA05) AS WA05,
				STRIP(WA06) AS WA06,
				STRIP(WA07) AS WA07,
				STRIP(WA08) AS WA08,
				STRIP(WA09) AS WA09,
				STRIP(WA10) AS WA10,
				STRIP(WA11) AS WA11,
				STRIP(WA12) AS WA12,
				STRIP(WA13) AS WA13,
				STRIP(WA14) AS WA14,
				STRIP(WA15) AS WA15,
				STRIP(WA16) AS WA16,
				STRIP(WA17) AS WA17,
				STRIP(WA18) AS WA18,
				STRIP(WA19) AS WA19,
				STRIP(WA20) AS WA20,
				STRIP(WA21) AS WA21,
				STRIP(WA22) AS WA22,
				STRIP(WA23) AS WA23,
				STRIP(WA24) AS WA24,
				STRIP(WA25) AS WA25,
				STRIP(WA26) AS WA26,
				STRIP(WA27) AS WA27,
				STRIP(WA28) AS WA28,
				STRIP(WA29) AS WA29,
				STRIP(WA30) AS WA30,
				STRIP(WA31) AS WA31,
				STRIP(WA32) AS WA32,
				STRIP(WA33) AS WA33,
				STRIP(WA081) AS WA081
			FROM <include refid="Utils.db2CommData"/>COM890WA
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="wa01">
				STRIP(WA01) = #wa01#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa02">
				STRIP(WA02) = #wa02#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa03">
				STRIP(WA03) = #wa03#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa04">
				STRIP(WA04) = #wa04#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa05">
				STRIP(WA05) = #wa05#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa06">
				STRIP(WA06) = #wa06#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa24IsNull">
				STRIP(WA24) = ''
			</isNotEmpty>
		</dynamic>
		<isEqual property="orderBySchdule" compareValue="Y">
			ORDER BY WA04,WA28,WA081
		</isEqual>
		<include refid="Utils.sql2" />
	</select>

	<select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
		SELECT STRIP(WA01) AS WA01,
				STRIP(WA02) AS WA02,
				STRIP(WA03) AS WA03,
				STRIP(WA04) AS WA04,
				STRIP(WA05) AS WA05,
				STRIP(WA06) AS WA06,
				STRIP(WA07) AS WA07,
				STRIP(WA08) AS WA08,
				STRIP(WA09) AS WA09,
				STRIP(WA10) AS WA10,
				STRIP(WA11) AS WA11,
				STRIP(WA12) AS WA12,
				STRIP(WA13) AS WA13,
				STRIP(WA14) AS WA14,
				STRIP(WA15) AS WA15,
				STRIP(WA16) AS WA16,
				STRIP(WA17) AS WA17,
				STRIP(WA18) AS WA18,
				STRIP(WA19) AS WA19,
				STRIP(WA20) AS WA20,
				STRIP(WA21) AS WA21,
				STRIP(WA22) AS WA22,
				STRIP(WA23) AS WA23,
				STRIP(WA24) AS WA24,
				STRIP(WA25) AS WA25,
				STRIP(WA26) AS WA26,
				STRIP(WA27) AS WA27,
				STRIP(WA28) AS WA28,
				STRIP(WA29) AS WA29,
				STRIP(WA30) AS WA30,
				STRIP(WA31) AS WA31,
				STRIP(WA32) AS WA32,
				STRIP(WA33) AS WA33,
				STRIP(WA081) AS WA081
			FROM <include refid="Utils.db2CommData"/>COM890WA
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="wa01">
				STRIP(WA01) = #wa01#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa02">
				STRIP(WA02) = #wa02#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa03">
				STRIP(WA03) = #wa03#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa04">
				STRIP(WA04) = #wa04#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa05">
				STRIP(WA05) = #wa05#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa06">
				STRIP(WA06) = #wa06#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa24IsNull">
				STRIP(WA24) = ''
			</isNotEmpty>
			
		</dynamic>
		<isEqual property="orderBySchdule" compareValue="Y">
			ORDER BY WA04,WA28,WA081
		</isEqual>
	</select>

 	
	<select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*) FROM <include refid="Utils.db2CommData"/>COM890WA
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="wa01">
				STRIP(WA01) = #wa01#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa02">
				STRIP(WA02) = #wa02#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa03">
				STRIP(WA03) = #wa03#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa04">
				STRIP(WA04) = #wa04#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa05">
				STRIP(WA05) = #wa05#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa06">
				STRIP(WA06) = #wa06#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wa24IsNull">
				STRIP(WA24) = ''
			</isNotEmpty>
		</dynamic>
	</select>

	<update id="updateForBatch" parameterClass="com.tlg.db2.entity.Com890wa">
		UPDATE <include refid="Utils.db2CommData" />COM890WA
		<dynamic prepend="set">
			<isNotNull prepend="," property="wa22">
				WA22 = #wa22:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="wa23">
				WA23 = #wa23:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="wa24">
				WA24 = #wa24:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="wa29">
				WA29 = #wa29:VARCHAR#
			</isNotNull>
		</dynamic>
		WHERE STRIP(WA04) = #wa04:VARCHAR#
		AND STRIP(WA28) = #wa28:VARCHAR#
		AND STRIP(WA081) = #wa081:VARCHAR#
	</update>

</sqlMap>