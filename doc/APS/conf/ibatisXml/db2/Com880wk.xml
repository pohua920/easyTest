<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<!-- mantis：OTH0132，處理人員：BI086，需求單編號：OTH0132  保單存摺AS400資料寫入核心中介Table -->
<sqlMap namespace="Com880wk">

	<resultMap id="BaseResultMap" class="com.tlg.db2.entity.Com880wk" >
	    <result column="WK01" property="wk01" jdbcType="VARCHAR" />
	    <result column="WK02" property="wk02" jdbcType="VARCHAR" />
	    <result column="WK03" property="wk03" jdbcType="VARCHAR" />
	    <result column="WK04" property="wk04" jdbcType="VARCHAR" />
	    <result column="WK05" property="wk05" jdbcType="VARCHAR" />
	    <result column="WK06" property="wk06" jdbcType="VARCHAR" />
	    <result column="WK07" property="wk07" jdbcType="VARCHAR" />
	    <result column="WK08" property="wk08" jdbcType="VARCHAR" />
	    <result column="WK09" property="wk09" jdbcType="VARCHAR" />
	    <result column="WK10" property="wk10" jdbcType="VARCHAR" />
	    <result column="WK11" property="wk11" jdbcType="VARCHAR" />
	    <result column="WK12" property="wk12" jdbcType="VARCHAR" />
	    <result column="WK13" property="wk13" jdbcType="VARCHAR" />
	    <result column="WK14" property="wk14" jdbcType="VARCHAR" />
	    <result column="WK15" property="wk15" jdbcType="VARCHAR" />
	    <result column="WK16" property="wk16" jdbcType="VARCHAR" />
	    <result column="WK17" property="wk17" jdbcType="VARCHAR" />
	    <result column="WK18" property="wk18" jdbcType="VARCHAR" />
	    <result column="WK19" property="wk19" jdbcType="VARCHAR" />
	    <result column="WK20" property="wk20" jdbcType="VARCHAR" />
	    <result column="WK21" property="wk21" jdbcType="VARCHAR" />
	    <result column="WK22" property="wk22" jdbcType="VARCHAR" />
	    <result column="WK23" property="wk23" jdbcType="VARCHAR" />
	    <result column="WK24" property="wk24" jdbcType="VARCHAR" />
	    <result column="WK25" property="wk25" jdbcType="VARCHAR" />
	    <result column="WK26" property="wk26" jdbcType="VARCHAR" />
	    <result column="WK27" property="wk27" jdbcType="VARCHAR" />
	    <result column="WK28" property="wk28" jdbcType="VARCHAR" />
	    <result column="WK29" property="wk29" jdbcType="VARCHAR" />
	    <result column="WK081" property="wk081" jdbcType="VARCHAR" />
  	</resultMap>

	<select id="selectByUnsend" resultMap="BaseResultMap" parameterClass="java.util.Map">
		SELECT
			STRIP(WK01) AS WK01,
			STRIP(WK02) AS WK02,
			STRIP(WK03) AS WK03,
			STRIP(WK04) AS WK04,
			STRIP(WK05) AS WK05,
			STRIP(WK06) AS WK06,
			STRIP(WK07) AS WK07,
			STRIP(WK08) AS WK08,
			STRIP(WK09) AS WK09,
			STRIP(WK10) AS WK10,
			STRIP(WK11) AS WK11,
			STRIP(WK12) AS WK12,
			STRIP(WK13) AS WK13,
			STRIP(WK14) AS WK14,
			STRIP(WK15) AS WK15,
			STRIP(WK16) AS WK16,
			STRIP(WK17) AS WK17,
			STRIP(WK18) AS WK18,
			STRIP(WK19) AS WK19,
			STRIP(WK20) AS WK20,
			STRIP(WK21) AS WK21,
			STRIP(WK22) AS WK22,
			STRIP(WK23) AS WK23,
			STRIP(WK24) AS WK24,
			STRIP(WK25) AS WK25,
			STRIP(WK26) AS WK26,
			STRIP(WK27) AS WK27,
			STRIP(WK28) AS WK28,
			STRIP(WK29) AS WK29,
			STRIP(WK081) AS WK081
		FROM <include refid="Utils.db2CommData"/>COM880WK
		WHERE STRIP(WK24) = ''
		AND STRIP(WK29) = ''
		ORDER BY STRIP(WK04),STRIP(WK28),STRIP(WK081)
		FETCH FIRST 500 ROW ONLY
	</select>

	<select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
		<include refid="Utils.sql1" />
			SELECT STRIP(WK01) AS WK01,
				STRIP(WK02) AS WK02,
				STRIP(WK03) AS WK03,
				STRIP(WK04) AS WK04,
				STRIP(WK05) AS WK05,
				STRIP(WK06) AS WK06,
				STRIP(WK07) AS WK07,
				STRIP(WK08) AS WK08,
				STRIP(WK09) AS WK09,
				STRIP(WK10) AS WK10,
				STRIP(WK11) AS WK11,
				STRIP(WK12) AS WK12,
				STRIP(WK13) AS WK13,
				STRIP(WK14) AS WK14,
				STRIP(WK15) AS WK15,
				STRIP(WK16) AS WK16,
				STRIP(WK17) AS WK17,
				STRIP(WK18) AS WK18,
				STRIP(WK19) AS WK19,
				STRIP(WK20) AS WK20,
				STRIP(WK21) AS WK21,
				STRIP(WK22) AS WK22,
				STRIP(WK23) AS WK23,
				STRIP(WK24) AS WK24,
				STRIP(WK25) AS WK25,
				STRIP(WK26) AS WK26,
				STRIP(WK27) AS WK27,
				STRIP(WK28) AS WK28,
				STRIP(WK29) AS WK29,
				STRIP(WK081) AS WK081
			FROM <include refid="Utils.db2CommData"/>COM880WK
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="wk01">
				WK01 = #wk01#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk02">
				WK02 = #wk02#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk03">
				WK03 = #wk03#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk04">
				WK04 = #wk04#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk05">
				WK05 = #wk05#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk06">
				WK06 = #wk06#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk24IsNull">
				STRIP(WK24) = ''
			</isNotEmpty>
		</dynamic>
		<isEqual property="orderBySchdule" compareValue="Y">
			ORDER BY WK04,WK28,WK081
		</isEqual>
		<include refid="Utils.sql2" />
	</select>

	<select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
		SELECT STRIP(WK01) AS WK01,
				STRIP(WK02) AS WK02,
				STRIP(WK03) AS WK03,
				STRIP(WK04) AS WK04,
				STRIP(WK05) AS WK05,
				STRIP(WK06) AS WK06,
				STRIP(WK07) AS WK07,
				STRIP(WK08) AS WK08,
				STRIP(WK09) AS WK09,
				STRIP(WK10) AS WK10,
				STRIP(WK11) AS WK11,
				STRIP(WK12) AS WK12,
				STRIP(WK13) AS WK13,
				STRIP(WK14) AS WK14,
				STRIP(WK15) AS WK15,
				STRIP(WK16) AS WK16,
				STRIP(WK17) AS WK17,
				STRIP(WK18) AS WK18,
				STRIP(WK19) AS WK19,
				STRIP(WK20) AS WK20,
				STRIP(WK21) AS WK21,
				STRIP(WK22) AS WK22,
				STRIP(WK23) AS WK23,
				STRIP(WK24) AS WK24,
				STRIP(WK25) AS WK25,
				STRIP(WK26) AS WK26,
				STRIP(WK27) AS WK27,
				STRIP(WK28) AS WK28,
				STRIP(WK29) AS WK29,
				STRIP(WK081) AS WK081
			FROM <include refid="Utils.db2CommData"/>COM880WK
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="wk01">
				WK01 = #wk01#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk02">
				WK02 = #wk02#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk03">
				WK03 = #wk03#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk04">
				WK04 = #wk04#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk05">
				WK05 = #wk05#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk06">
				WK06 = #wk06#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk24IsNull">
				STRIP(WK24) = ''
			</isNotEmpty>
			
		</dynamic>
		<isEqual property="orderBySchdule" compareValue="Y">
			ORDER BY WK04,WK28,WK081
		</isEqual>
	</select>

 	
	<select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*) FROM <include refid="Utils.db2CommData"/>COM880WK
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="wk01">
				WK01 = #wk01#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk02">
				WK02 = #wk02#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk03">
				WK03 = #wk03#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk04">
				WK04 = #wk04#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk05">
				WK05 = #wk05#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk06">
				WK06 = #wk06#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="wk24IsNull">
				STRIP(WK24) = ''
			</isNotEmpty>
		</dynamic>
	</select>

	<update id="updateForBatch" parameterClass="com.tlg.db2.entity.Com880wk">
		UPDATE <include refid="Utils.db2CommData" />COM880WK
		<dynamic prepend="set">
			<isNotNull prepend="," property="wk22">
				WK22 = #wk22:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="wk23">
				WK23 = #wk23:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="wk24">
				WK24 = #wk24:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="wk29">
				WK29 = #wk29:VARCHAR#
			</isNotNull>
		</dynamic>
		WHERE STRIP(WK04) = #wk04:VARCHAR#
		AND STRIP(WK28) = #wk28:VARCHAR#
		AND STRIP(WK081) = #wk081:VARCHAR#
	</update>

</sqlMap>