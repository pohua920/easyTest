<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Prpdagent">
  <resultMap class="com.tlg.sales.entity.Prpdagent" id="BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 30 10:31:08 CST 2021.
    -->
    <result column="AGENTCODE" jdbcType="VARCHAR" property="agentcode" />
    <result column="AGENTNAME" jdbcType="VARCHAR" property="agentname" />
    <result column="ADDRESSNAME" jdbcType="VARCHAR" property="addressname" />
    <result column="POSTCODE" jdbcType="VARCHAR" property="postcode" />
    <result column="AGENTTYPE" jdbcType="VARCHAR" property="agenttype" />
    <result column="PERMITNO" jdbcType="VARCHAR" property="permitno" />
    <result column="LINKERNAME" jdbcType="VARCHAR" property="linkername" />
    <result column="BARGAINDATE" jdbcType="TIMESTAMP" property="bargaindate" />
    <result column="PHONENUMBER" jdbcType="VARCHAR" property="phonenumber" />
    <result column="FAXNUMBER" jdbcType="VARCHAR" property="faxnumber" />
    <result column="COMCODE" jdbcType="VARCHAR" property="comcode" />
    <result column="HANDLERCODE" jdbcType="VARCHAR" property="handlercode" />
    <result column="UPPERAGENTCODE" jdbcType="VARCHAR" property="upperagentcode" />
    <result column="NEWAGENTCODE" jdbcType="VARCHAR" property="newagentcode" />
    <result column="VALIDSTATUS" jdbcType="VARCHAR" property="validstatus" />
    <result column="ARTICLECODE" jdbcType="VARCHAR" property="articlecode" />
    <result column="FLAG" jdbcType="VARCHAR" property="flag" />
    <result column="AGENTENAME" jdbcType="VARCHAR" property="agentename" />
    <result column="PERMITFLAG" jdbcType="VARCHAR" property="permitflag" />
    <result column="PRINCIPALNAME" jdbcType="VARCHAR" property="principalname" />
    <result column="MOBILE" jdbcType="VARCHAR" property="mobile" />
    <result column="EMAIL" jdbcType="VARCHAR" property="email" />
    <result column="NETADDRESS" jdbcType="VARCHAR" property="netaddress" />
    <result column="BANK" jdbcType="VARCHAR" property="bank" />
    <result column="ACCOUNT" jdbcType="VARCHAR" property="account" />
    <result column="LOWERVIEWFLAG" jdbcType="VARCHAR" property="lowerviewflag" />
    <result column="AGENTSHORTNAME" jdbcType="VARCHAR" property="agentshortname" />
    <result column="PERMITSTARTDATE" jdbcType="TIMESTAMP" property="permitstartdate" />
    <result column="PERMITENDDATE" jdbcType="TIMESTAMP" property="permitenddate" />
    <result column="CANCELDATE" jdbcType="TIMESTAMP" property="canceldate" />
    <result column="RECOVERDATE" jdbcType="TIMESTAMP" property="recoverdate" />
    <result column="CREATEDATE" jdbcType="TIMESTAMP" property="createdate" />
    <result column="CREATERCODE" jdbcType="VARCHAR" property="creatercode" />
    <result column="CREATERNAME" jdbcType="VARCHAR" property="creatername" />
    <result column="DISTANCEFLAG" jdbcType="VARCHAR" property="distanceflag" />
    <result column="AGENTCLASS" jdbcType="VARCHAR" property="agentclass" />
    <result column="NXGDTYPE" jdbcType="VARCHAR" property="nxgdtype" />
    <result column="BANKNAME" jdbcType="VARCHAR" property="bankname" />
    <result column="BRANCHCODE" jdbcType="VARCHAR" property="branchcode" />
    <result column="LOGOUTTYPE" jdbcType="VARCHAR" property="logouttype" />
    <result column="LOGOUTREASON" jdbcType="VARCHAR" property="logoutreason" />
    <result column="MARKETTEAMFLAG" jdbcType="VARCHAR" property="marketteamflag" />
    <result column="TEAMCODE" jdbcType="VARCHAR" property="teamcode" />
    <result column="TEAMNAME" jdbcType="VARCHAR" property="teamname" />
    <result column="BANKOFPROVINCE" jdbcType="VARCHAR" property="bankofprovince" />
    <result column="BANKOFCITY" jdbcType="VARCHAR" property="bankofcity" />
    <result column="BANKTYPE" jdbcType="VARCHAR" property="banktype" />
    <result column="CNAP" jdbcType="VARCHAR" property="cnap" />
    <result column="DISTANCETYPE" jdbcType="VARCHAR" property="distancetype" />
    <result column="PAYTYPE" jdbcType="VARCHAR" property="paytype" />
    <result column="BUSINESSSOURCE" jdbcType="VARCHAR" property="businesssource" />
    <result column="UNITECODE" jdbcType="VARCHAR" property="unitecode" />
    <result column="INVOICETYPE" jdbcType="VARCHAR" property="invoicetype" />
    <result column="INVOICENAME" jdbcType="VARCHAR" property="invoicename" />
    <result column="ORGICODE" jdbcType="VARCHAR" property="orgicode" />
    <result column="CHANNELTYPE" jdbcType="VARCHAR" property="channeltype" />
    <result column="UNITCODE" jdbcType="VARCHAR" property="unitcode" />
    <result column="UNITNAME" jdbcType="VARCHAR" property="unitname" />
    <result column="VALIDDATE" jdbcType="TIMESTAMP" property="validdate" />
    <result column="MAINBANKCODE" jdbcType="VARCHAR" property="mainbankcode" />
    <result column="SUBBANKCODE" jdbcType="VARCHAR" property="subbankcode" />
    <result column="LOGINCODE" jdbcType="VARCHAR" property="logincode" />
    <result column="IUPDATE" jdbcType="VARCHAR" property="iupdate" />
    <result column="DUPDATE" jdbcType="TIMESTAMP" property="dupdate" />
    <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 start -->
    <result column="MAILLOG" jdbcType="TIMESTAMP" property="maillog" />
    <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 end -->
  </resultMap>
  
  <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 start -->
  <resultMap class="com.tlg.aps.vo.SalesAgentDateAlertVo" id="salesAgentDateAlertVoResultMap">
  	<result column="AGENTCODE" jdbcType="VARCHAR" property="agentcode" />
  	<result column="MOBILE" jdbcType="VARCHAR" property="mobile" />
  	<result column="EMAIL" jdbcType="VARCHAR" property="email" />
  	<result column="AGENTNAME" jdbcType="VARCHAR" property="agentname" />
  	<result column="LOGINCODE" jdbcType="VARCHAR" property="logincode" />
  	<result column="LOGINENDDATE" jdbcType="TIMESTAMP" property="loginenddate" />
  	<result column="MAILLOG" jdbcType="TIMESTAMP" property="maillog" />
  </resultMap>
  <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 end -->

  <sql id="Base_Column_List">
  	  AGENTCODE, AGENTNAME, ADDRESSNAME, POSTCODE, AGENTTYPE, PERMITNO, LINKERNAME,
      BARGAINDATE, PHONENUMBER, FAXNUMBER, COMCODE, HANDLERCODE, UPPERAGENTCODE, NEWAGENTCODE,
      VALIDSTATUS, ARTICLECODE, FLAG, AGENTENAME, PERMITFLAG, PRINCIPALNAME, MOBILE, EMAIL,
      NETADDRESS, BANK, ACCOUNT, LOWERVIEWFLAG, AGENTSHORTNAME, PERMITSTARTDATE, PERMITENDDATE,
      CANCELDATE, RECOVERDATE, CREATEDATE, CREATERCODE, CREATERNAME, DISTANCEFLAG, AGENTCLASS,
      NXGDTYPE, BANKNAME, BRANCHCODE, LOGOUTTYPE, LOGOUTREASON, MARKETTEAMFLAG, TEAMCODE, TEAMNAME,
      BANKOFPROVINCE, BANKOFCITY, BANKTYPE, CNAP, DISTANCETYPE, PAYTYPE, BUSINESSSOURCE, UNITECODE,
      INVOICETYPE, INVOICENAME, ORGICODE, CHANNELTYPE, UNITCODE, UNITNAME, VALIDDATE, MAINBANKCODE,
      <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 -->
      SUBBANKCODE, LOGINCODE, IUPDATE, DUPDATE, MAILLOG
  </sql>

  <select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
	<include refid="Utils.sql1" />
		SELECT * FROM <include refid="Utils.salesSchema"/>PRPDAGENT
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="businesssource">
			BUSINESSSOURCE = #businesssource#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentcode">
			AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentname">
			AGENTNAME = #agentname#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="logincode">
			LOGINCODE = #logincode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="unitcode">
			UNITCODE = #unitcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="unitcodeLike">
			UNITCODE LIKE #unitcodeLike# || '%'
		</isNotEmpty>
		<isEqual prepend="AND" property="handlerStatus" compareValue="N">
			HANDLERCODE IS NULL
		</isEqual>
		<isEqual prepend="AND" property="handlerStatus" compareValue="Y">
			HANDLERCODE IS NOT NULL
		</isEqual>
		<isNotEmpty prepend="AND" property="handlercode">
			HANDLERCODE = #handlercode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agenttype">
			AGENTTYPE = #agenttype#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			VALIDSTATUS = #validstatus#
		</isNotEmpty>
	</dynamic>
	<include refid="Utils.sql2" />
  </select>
  
  <select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
	SELECT COUNT(*) FROM <include refid="Utils.salesSchema"/>PRPDAGENT
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="businesssource">
			BUSINESSSOURCE = #businesssource#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentcode">
			AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentname">
			AGENTNAME = #agentname#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="logincode">
			LOGINCODE = #logincode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="unitcode">
			UNITCODE = #unitcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="unitcodeLike">
			UNITCODE LIKE #unitcodeLike# || '%'
		</isNotEmpty>
		<isEqual prepend="AND" property="handlerStatus" compareValue="N">
			HANDLERCODE IS NULL
		</isEqual>
		<isEqual prepend="AND" property="handlerStatus" compareValue="Y">
			HANDLERCODE IS NOT NULL
		</isEqual>
		<isNotEmpty prepend="AND" property="handlercode">
			HANDLERCODE = #handlercode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agenttype">
			AGENTTYPE = #agenttype#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			VALIDSTATUS = #validstatus#
		</isNotEmpty>
	</dynamic>
  </select>

  <select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
	SELECT * FROM <include refid="Utils.salesSchema"/>PRPDAGENT
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="businesssource">
			BUSINESSSOURCE = #businesssource#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentcode">
			AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentname">
			AGENTNAME = #agentname#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="logincode">
			LOGINCODE = #logincode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="unitcode">
			UNITCODE = #unitcode#
		</isNotEmpty>
		<!-- mantis：SALES0014，處理人員：CC009，需求單編號：SALES0014 銷管系統-APS-所屬服務人員維護新增批次上下傳功能 start -->
		<isNotEmpty prepend="AND" property="unitcodeIsNull">
			(UNITCODE is null or UNITCODE = '')
		</isNotEmpty>
		<!-- mantis：SALES0014，處理人員：CC009，需求單編號：SALES0014 銷管系統-APS-所屬服務人員維護新增批次上下傳功能 end -->
		<isNotEmpty prepend="AND" property="handlercode">
			HANDLERCODE = #handlercode#
		</isNotEmpty>
		<isNotNull property="agenttypeList" prepend="AND"> 
			AGENTTYPE IN
			<iterate open="(" close=")" conjunction="," property="agenttypeList"> #agenttypeList[]# </iterate>
		</isNotNull>
		<isNotEmpty prepend="AND" property="orgicode">
			ORGICODE = #orgicode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			VALIDSTATUS = #validstatus#
		</isNotEmpty>
	</dynamic>
  </select>
  
  <select id="selectByUK" resultClass="com.tlg.sales.entity.Prpdagent" parameterClass="java.util.Map" >
	SELECT * FROM <include refid="Utils.salesSchema"/>PRPDAGENT
	where AGENTCODE = #agentcode:VARCHAR#
  </select>
	
  <delete id="delete" parameterClass="com.tlg.sales.entity.Prpdagent">
    delete from <include refid="Utils.salesSchema"/>PRPDAGENT
    where AGENTCODE = #agentcode:VARCHAR#
  </delete>
  
  <insert id="insert" parameterClass="com.tlg.sales.entity.Prpdagent">
    insert into <include refid="Utils.salesSchema"/>PRPDAGENT (AGENTCODE, AGENTNAME, ADDRESSNAME, POSTCODE, AGENTTYPE, PERMITNO,
      LINKERNAME, BARGAINDATE, PHONENUMBER, FAXNUMBER, COMCODE, HANDLERCODE, UPPERAGENTCODE,
      NEWAGENTCODE, VALIDSTATUS, ARTICLECODE, FLAG, AGENTENAME, PERMITFLAG, PRINCIPALNAME, MOBILE,
      EMAIL, NETADDRESS, BANK, ACCOUNT, LOWERVIEWFLAG, AGENTSHORTNAME, PERMITSTARTDATE,
      PERMITENDDATE, CANCELDATE, RECOVERDATE, CREATEDATE, CREATERCODE, CREATERNAME, DISTANCEFLAG,
      AGENTCLASS, NXGDTYPE, BANKNAME, BRANCHCODE, LOGOUTTYPE, LOGOUTREASON, MARKETTEAMFLAG,
      TEAMCODE, TEAMNAME, BANKOFPROVINCE, BANKOFCITY, BANKTYPE, CNAP, DISTANCETYPE, PAYTYPE,
      BUSINESSSOURCE, UNITECODE, INVOICETYPE, INVOICENAME, ORGICODE, CHANNELTYPE, UNITCODE,
      <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 -->
      UNITNAME, VALIDDATE, MAINBANKCODE, SUBBANKCODE, LOGINCODE, IUPDATE, DUPDATE, MAILLOG)
    values (#agentcode:VARCHAR#, #agentname:VARCHAR#, #addressname:VARCHAR#, #postcode:VARCHAR#,
      #agenttype:VARCHAR#, #permitno:VARCHAR#, #linkername:VARCHAR#, #bargaindate:TIMESTAMP#,
      #phonenumber:VARCHAR#, #faxnumber:VARCHAR#, #comcode:VARCHAR#, #handlercode:VARCHAR#,
      #upperagentcode:VARCHAR#, #newagentcode:VARCHAR#, #validstatus:VARCHAR#,
      #articlecode:VARCHAR#, #flag:VARCHAR#, #agentename:VARCHAR#, #permitflag:VARCHAR#,
      #principalname:VARCHAR#, #mobile:VARCHAR#, #email:VARCHAR#, #netaddress:VARCHAR#,
      #bank:VARCHAR#, #account:VARCHAR#, #lowerviewflag:VARCHAR#, #agentshortname:VARCHAR#,
      #permitstartdate:TIMESTAMP#, #permitenddate:TIMESTAMP#, #canceldate:TIMESTAMP#,
      #recoverdate:TIMESTAMP#, #createdate:TIMESTAMP#, #creatercode:VARCHAR#, #creatername:VARCHAR#,
      #distanceflag:VARCHAR#, #agentclass:VARCHAR#, #nxgdtype:VARCHAR#, #bankname:VARCHAR#,
      #branchcode:VARCHAR#, #logouttype:VARCHAR#, #logoutreason:VARCHAR#, #marketteamflag:VARCHAR#,
      #teamcode:VARCHAR#, #teamname:VARCHAR#, #bankofprovince:VARCHAR#, #bankofcity:VARCHAR#,
      #banktype:VARCHAR#, #cnap:VARCHAR#, #distancetype:VARCHAR#, #paytype:VARCHAR#,
      #businesssource:VARCHAR#, #unitecode:VARCHAR#, #invoicetype:VARCHAR#, #invoicename:VARCHAR#,
      #orgicode:VARCHAR#, #channeltype:VARCHAR#, #unitcode:VARCHAR#, #unitname:VARCHAR#,
      #validdate:TIMESTAMP#, #mainbankcode:VARCHAR#, #subbankcode:VARCHAR#, #logincode:VARCHAR#,
      <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 -->
      #iupdate:VARCHAR#, #dupdate:TIMESTAMP#, #maillog:TIMESTAMP#)
  </insert>

  <update id="update" parameterClass="com.tlg.sales.entity.Prpdagent">
    update <include refid="Utils.salesSchema"/>PRPDAGENT
    <dynamic prepend="set">
      <isNotNull prepend="," property="agentname">
        AGENTNAME = #agentname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="addressname">
        ADDRESSNAME = #addressname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="postcode">
        POSTCODE = #postcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="agenttype">
        AGENTTYPE = #agenttype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="permitno">
        PERMITNO = #permitno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="linkername">
        LINKERNAME = #linkername:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bargaindate">
        BARGAINDATE = #bargaindate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="phonenumber">
        PHONENUMBER = #phonenumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="faxnumber">
        FAXNUMBER = #faxnumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="comcode">
        COMCODE = #comcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="handlercode">
        HANDLERCODE = #handlercode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="upperagentcode">
        UPPERAGENTCODE = #upperagentcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="newagentcode">
        NEWAGENTCODE = #newagentcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="validstatus">
        VALIDSTATUS = #validstatus:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="articlecode">
        ARTICLECODE = #articlecode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="flag">
        FLAG = #flag:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="agentename">
        AGENTENAME = #agentename:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="permitflag">
        PERMITFLAG = #permitflag:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="principalname">
        PRINCIPALNAME = #principalname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="mobile">
        MOBILE = #mobile:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="email">
        EMAIL = #email:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="netaddress">
        NETADDRESS = #netaddress:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bank">
        BANK = #bank:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="account">
        ACCOUNT = #account:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="lowerviewflag">
        LOWERVIEWFLAG = #lowerviewflag:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="agentshortname">
        AGENTSHORTNAME = #agentshortname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="permitstartdate">
        PERMITSTARTDATE = #permitstartdate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="permitenddate">
        PERMITENDDATE = #permitenddate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="canceldate">
        CANCELDATE = #canceldate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="recoverdate">
        RECOVERDATE = #recoverdate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="createdate">
        CREATEDATE = #createdate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="creatercode">
        CREATERCODE = #creatercode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="creatername">
        CREATERNAME = #creatername:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="distanceflag">
        DISTANCEFLAG = #distanceflag:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="agentclass">
        AGENTCLASS = #agentclass:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nxgdtype">
        NXGDTYPE = #nxgdtype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bankname">
        BANKNAME = #bankname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="branchcode">
        BRANCHCODE = #branchcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="logouttype">
        LOGOUTTYPE = #logouttype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="logoutreason">
        LOGOUTREASON = #logoutreason:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="marketteamflag">
        MARKETTEAMFLAG = #marketteamflag:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="teamcode">
        TEAMCODE = #teamcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="teamname">
        TEAMNAME = #teamname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bankofprovince">
        BANKOFPROVINCE = #bankofprovince:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="bankofcity">
        BANKOFCITY = #bankofcity:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="banktype">
        BANKTYPE = #banktype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="cnap">
        CNAP = #cnap:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="distancetype">
        DISTANCETYPE = #distancetype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="paytype">
        PAYTYPE = #paytype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="businesssource">
        BUSINESSSOURCE = #businesssource:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="unitecode">
        UNITECODE = #unitecode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="invoicetype">
        INVOICETYPE = #invoicetype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="invoicename">
        INVOICENAME = #invoicename:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="orgicode">
        ORGICODE = #orgicode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="channeltype">
        CHANNELTYPE = #channeltype:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="unitcode">
        UNITCODE = #unitcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="unitname">
        UNITNAME = #unitname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="validdate">
        VALIDDATE = #validdate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="mainbankcode">
        MAINBANKCODE = #mainbankcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="subbankcode">
        SUBBANKCODE = #subbankcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="logincode">
        LOGINCODE = #logincode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="iupdate">
        IUPDATE = #iupdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dupdate">
        DUPDATE = #dupdate:TIMESTAMP#
      </isNotNull>
      <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 start -->
      <isNotNull prepend="," property="maillog">
        MAILLOG = #maillog:VARCHAR#
      </isNotNull>
      <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 end -->
    </dynamic>
    where AGENTCODE = #agentcode:VARCHAR#
  </update>
  
  <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 start -->
  <select id="selectForSalesAgentDateAlert" resultMap="salesAgentDateAlertVoResultMap" parameterClass="java.util.Map">
		SELECT AG.AGENTCODE,AG.MAILLOG,AG.MOBILE,AG.EMAIL,AG.AGENTNAME,AG.LOGINCODE,IDV.LOGINENDDATE
		FROM SALES.PRPDAGENT AG 
		JOIN SALES.PRPDAGENTIDV IDV ON AG.AGENTCODE=IDV.AGENTCODE 
		WHERE AG.VALIDSTATUS='1'
		<isNotEmpty prepend="AND" property="sysdate">
<!-- 			IDV.LOGINENDDATE = TO_DATE(TO_CHAR(ADD_MONTHS(#sysdate:TIMESTAMP#,3),'YYYY/MM/DD'),'YYYY/MM/DD') -->
			IDV.LOGINENDDATE = TO_DATE(#sysdate#,'YYYY/MM/DD')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="email">
			AG.EMAIL like '%@%' 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="mobile">
			AG.MOBILE is not null 
			AND length(AG.MOBILE)=10 
			AND substr(AG.MOBILE,1,2)='09'
		</isNotEmpty>
  </select>
  
  <select id="selectForAps043" resultMap="salesAgentDateAlertVoResultMap" parameterClass="java.util.Map">
	<include refid="Utils.sql1" />
		SELECT AG.AGENTCODE,AG.MAILLOG,AG.MOBILE,AG.EMAIL,AG.AGENTNAME,AG.LOGINCODE,IDV.LOGINENDDATE
		FROM SALES.PRPDAGENT AG 
		JOIN SALES.PRPDAGENTIDV IDV ON AG.AGENTCODE=IDV.AGENTCODE 
		WHERE AG.VALIDSTATUS='1'
		<isNotEmpty prepend="AND" property="logincode">
			AG.LOGINCODE = #logincode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sLoginenddate">
			IDV.LOGINENDDATE <![CDATA[>=]]> to_date(#sLoginenddate# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eLoginenddate">
			IDV.LOGINENDDATE <![CDATA[<=]]> to_date(#eLoginenddate# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sMaillog">
			AG.MAILLOG <![CDATA[>=]]> to_date(#sMaillog# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eMaillog">
			AG.MAILLOG <![CDATA[<=]]> to_date(#eMaillog# , 'yyyy/mm/dd hh24:mi:ss')
		</isNotEmpty>
	<include refid="Utils.sql2" />
  </select>
  
  <select id="countForAps043" resultClass="java.lang.Integer" parameterClass="java.util.Map">
	SELECT COUNT(*)
	FROM SALES.PRPDAGENT AG 
	JOIN SALES.PRPDAGENTIDV IDV ON AG.AGENTCODE=IDV.AGENTCODE 
	WHERE AG.VALIDSTATUS='1'
	<isNotEmpty prepend="AND" property="logincode">
		AG.LOGINCODE = #logincode#
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="sLoginenddate">
		IDV.LOGINENDDATE <![CDATA[>=]]> to_date(#sLoginenddate# , 'yyyy/mm/dd hh24:mi:ss')
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="eLoginenddate">
		IDV.LOGINENDDATE <![CDATA[<=]]> to_date(#eLoginenddate# , 'yyyy/mm/dd hh24:mi:ss')
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="sMaillog">
		AG.MAILLOG <![CDATA[>=]]> to_date(#sMaillog# , 'yyyy/mm/dd hh24:mi:ss')
	</isNotEmpty>
	<isNotEmpty prepend="AND" property="eMaillog">
		AG.MAILLOG <![CDATA[<=]]> to_date(#eMaillog# , 'yyyy/mm/dd hh24:mi:ss')
	</isNotEmpty>
  </select>
  <!-- mantis：Sales0024，處理人員：CC009，需求單編號：Sales0024 銷管系統-業務員登錄證到期提醒Mail與簡訊通知排程 end -->

  <!-- mantis：FIR0571，處理人員：BJ085，需求單編號：FIR0571 住火_APS到期通知處理作業-新增印刷廠產檔作業規格 start -->
  <resultMap class="com.tlg.sales.entity.Prpdagent" id="FirChangeHandlecodeMap">
    <result column="HANDLERCODE" jdbcType="VARCHAR" property="handlercode" />
    <result column="VALIDSTATUS" jdbcType="VARCHAR" property="validstatus" />
  </resultMap>
  
  <select id="selectForFirChangeHandler1code" resultMap="FirChangeHandlecodeMap" parameterClass="java.util.Map">
	SELECT HANDLERCODE, VALIDSTATUS FROM SALES.PRPDAGENT PA 
	WHERE PA.AGENTTYPE = '1' 
	AND PA.BUSINESSSOURCE IN ('B88801','B99901')
	AND PA.LOGINCODE = #logincode:VARCHAR#
  </select>
  <!-- mantis：FIR0571，處理人員：BJ085，需求單編號：FIR0571 住火_APS到期通知處理作業-新增印刷廠產檔作業規格 end -->
</sqlMap>