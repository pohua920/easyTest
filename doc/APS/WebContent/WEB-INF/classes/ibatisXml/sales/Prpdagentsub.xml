<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Prpdagentsub" >
  <resultMap id="BaseResultMap" class="com.tlg.sales.entity.Prpdagentsub" >
    <result column="AGENTCODE" property="agentcode" jdbcType="VARCHAR" />
    <result column="AGENTSUBCODE" property="agentsubcode" jdbcType="VARCHAR" />
    <result column="AGENTSUBNAME" property="agentsubname" jdbcType="VARCHAR" />
    <result column="ADDRESSNAME" property="addressname" jdbcType="VARCHAR" />
    <result column="POSTCODE" property="postcode" jdbcType="VARCHAR" />
    <result column="PHONENUMBER" property="phonenumber" jdbcType="VARCHAR" />
    <result column="FAXNUMBER" property="faxnumber" jdbcType="VARCHAR" />
    <result column="EMAIL" property="email" jdbcType="VARCHAR" />
    <result column="VALIDSTATUS" property="validstatus" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
    <result column="ICREATE" property="icreate" jdbcType="VARCHAR" />
    <result column="DCREATE" property="dcreate" jdbcType="TIMESTAMP" />
    <result column="IUPDATE" property="iupdate" jdbcType="VARCHAR" />
    <result column="DUPDATE" property="dupdate" jdbcType="TIMESTAMP" />
    <result column="KIND" property="kind" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="ForAps028ResultMap" class="com.tlg.aps.vo.Aps028ResultVo" >
    <result column="AGENTCODE" property="agentcode" jdbcType="VARCHAR" />
    <result column="AGENTSUBCODE" property="agentsubcode" jdbcType="VARCHAR" />
    <result column="AGENTSUBNAME" property="agentsubname" jdbcType="VARCHAR" />
    <result column="ADDRESSNAME" property="addressname" jdbcType="VARCHAR" />
    <result column="POSTCODE" property="postcode" jdbcType="VARCHAR" />
    <result column="PHONENUMBER" property="phonenumber" jdbcType="VARCHAR" />
    <result column="FAXNUMBER" property="faxnumber" jdbcType="VARCHAR" />
    <result column="EMAIL" property="email" jdbcType="VARCHAR" />
    <result column="VALIDSTATUS" property="validstatus" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
    <result column="ICREATE" property="icreate" jdbcType="VARCHAR" />
    <result column="DCREATE" property="dcreate" jdbcType="TIMESTAMP" />
    <result column="IUPDATE" property="iupdate" jdbcType="VARCHAR" />
    <result column="DUPDATE" property="dupdate" jdbcType="TIMESTAMP" />
    <result column="ORGICODE" property="orgicode" jdbcType="VARCHAR" />
    <result column="KIND" property="kind" jdbcType="VARCHAR" />
  </resultMap>
 
 <select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
	<include refid="Utils.sql1" />
		SELECT * FROM <include refid="Utils.salesSchema"/>PRPDAGENTSUB
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="agentcode">
			AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubcode">
			AGENTSUBCODE = #agentsubcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			VALIDSTATUS = #validstatus#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubnameLike">
			AGENTSUBNAME like '%'||#agentsubnameLike#||'%'
		</isNotEmpty>
	</dynamic>
	<include refid="Utils.sql2" />
  </select>
 
  <select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
	SELECT COUNT(*) FROM <include refid="Utils.salesSchema"/>PRPDAGENTSUB
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="agentcode">
			AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubcode">
			AGENTSUBCODE = #agentsubcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			VALIDSTATUS = #validstatus#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubnameLike">
			AGENTSUBNAME like '%'||#agentsubnameLike#||'%'
		</isNotEmpty>
	</dynamic>
  </select>
  
   <select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
	SELECT * FROM <include refid="Utils.salesSchema"/>PRPDAGENTSUB
	<dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="agentcode">
			AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubname">
			AGENTSUBNAME = #agentsubname#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubcode">
			AGENTSUBCODE = #agentsubcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			VALIDSTATUS = #validstatus#
		</isNotEmpty>
	</dynamic>
  </select>
  
  <select id="selectMaxAgentsubcode" resultClass="java.lang.Integer" parameterClass="java.util.Map">
	SELECT MAX(TO_NUMBER(AGENTSUBCODE)) 
	<include refid="Utils.salesSchema"/>FROM PRPDAGENTSUB
  </select>
  
  <select id="selectByUK" resultClass="com.tlg.sales.entity.Prpdagentsub" parameterClass="java.util.Map" >
	SELECT * FROM <include refid="Utils.salesSchema"/>PRPDAGENTSUB
		where AGENTCODE = #agentcode:VARCHAR#
      	and AGENTSUBCODE = #agentsubcode:VARCHAR#
  </select>

  <select id="countByUK" resultClass="java.lang.Integer" parameterClass="com.tlg.sales.entity.Prpdagentsub" >
		SELECT COUNT(*) FROM <include refid="Utils.salesSchema"/>PRPDAGENTSUB
		where AGENTCODE = #agentcode:VARCHAR#
      	and AGENTSUBCODE = #agentsubcode:VARCHAR#
  </select>
  
  <select id="selectForAps028" resultMap="ForAps028ResultMap" parameterClass="java.util.Map">
	<include refid="Utils.sql1" />
		SELECT A.* ,B.ORGICODE 
		FROM <include refid="Utils.salesSchema"/>PRPDAGENTSUB A 
		JOIN PRPDAGENT B ON A.AGENTCODE = B.AGENTCODE
		WHERE B.VALIDSTATUS='1'
		AND B.AGENTTYPE IN ('2','3')
		<isNotEmpty prepend="AND" property="agentcode">
			A.AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubcode">
			A.AGENTSUBCODE = #agentsubcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			A.VALIDSTATUS = #validstatus#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubnameLike">
			A.AGENTSUBNAME like '%'||#agentsubnameLike#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="orgicode">
			B.ORGICODE = #orgicode#
		</isNotEmpty>
		<isNotNull prepend="AND" property="kindList"> 
			A.KIND IN
			<iterate open="(" close=")" conjunction="," property="kindList"> #kindList[]# </iterate>
		</isNotNull>
	<include refid="Utils.sql2" />
  </select>
  
  <select id="countForAps028" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*)	FROM <include refid="Utils.salesSchema"/>PRPDAGENTSUB A 
		JOIN PRPDAGENT B ON A.AGENTCODE = B.AGENTCODE
		WHERE B.VALIDSTATUS='1'
		AND B.AGENTTYPE IN ('2','3')
		<isNotEmpty prepend="AND" property="agentcode">
			A.AGENTCODE = #agentcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubcode">
			A.AGENTSUBCODE = #agentsubcode#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="validstatus">
			A.VALIDSTATUS = #validstatus#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="agentsubnameLike">
			A.AGENTSUBNAME like '%'||#agentsubnameLike#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="orgicode">
			B.ORGICODE = #orgicode#
		</isNotEmpty>
		<isNotNull prepend="AND" property="kindList"> 
			A.KIND IN
			<iterate open="(" close=")" conjunction="," property="kindList"> #kindList[]# </iterate>
		</isNotNull>
  </select>

  <delete id="deleteByEntity" parameterClass="com.tlg.sales.entity.Prpdagentsub" >
    delete from <include refid="Utils.salesSchema"/>PRPDAGENTSUB
    where AGENTCODE = #agentcode:VARCHAR#
      and AGENTSUBCODE = #agentsubcode:VARCHAR#
  </delete>

  <insert id="insert" parameterClass="com.tlg.sales.entity.Prpdagentsub" >
    insert into <include refid="Utils.salesSchema"/>PRPDAGENTSUB (AGENTCODE, AGENTSUBCODE, AGENTSUBNAME, ADDRESSNAME, POSTCODE,
      PHONENUMBER, FAXNUMBER, EMAIL, VALIDSTATUS, REMARK, ICREATE, DCREATE, IUPDATE, DUPDATE, KIND)
    values (#agentcode:VARCHAR#, #agentsubcode:VARCHAR#, #agentsubname:VARCHAR#,
      #addressname:VARCHAR#, #postcode:VARCHAR#, #phonenumber:VARCHAR#, #faxnumber:VARCHAR#,
      #email:VARCHAR#, #validstatus:VARCHAR#, #remark:VARCHAR#, #icreate:VARCHAR#, #dcreate:TIMESTAMP#,
      #iupdate:VARCHAR#, #dupdate:TIMESTAMP#, #kind:VARCHAR#)
  </insert>

  <update id="update" parameterClass="com.tlg.sales.entity.Prpdagentsub" >
    update <include refid="Utils.salesSchema"/>PRPDAGENTSUB
    <dynamic prepend="set" >
      <isNotNull prepend="," property="agentsubname" >
        AGENTSUBNAME = #agentsubname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="addressname" >
        ADDRESSNAME = #addressname:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="postcode" >
        POSTCODE = #postcode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="phonenumber" >
        PHONENUMBER = #phonenumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="faxnumber" >
        FAXNUMBER = #faxnumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="email" >
        EMAIL = #email:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="validstatus" >
        VALIDSTATUS = #validstatus:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="remark" >
        REMARK = #remark:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="icreate" >
        ICREATE = #icreate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dcreate" >
        DCREATE = #dcreate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="iupdate" >
        IUPDATE = #iupdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dupdate" >
        DUPDATE = #dupdate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="kind" >
        KIND = #kind:VARCHAR#
      </isNotNull>
    </dynamic>
    where AGENTCODE = #agentcode:VARCHAR#
      and AGENTSUBCODE = #agentsubcode:VARCHAR#
  </update>
</sqlMap>