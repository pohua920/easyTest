<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!-- mantis：FIR0181， 中信新件流程-排程查詢作業(含產生查詢及回饋查詢)
調整角色權限控管功能，後USER決定取消此功能 -->
<sqlMap namespace="FirApsCtbcHandler">
  <resultMap class="com.tlg.prpins.entity.FirApsCtbcHandler" id="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 10 14:00:16 CST 2020.
    -->
    <result column="OID" jdbcType="DECIMAL" property="oid" />
    <result column="USERCODE" jdbcType="VARCHAR" property="usercode" />
    <result column="COMCODE" jdbcType="VARCHAR" property="comcode" />
    <result column="UPPERCOMCODE" jdbcType="VARCHAR" property="uppercomcode" />
    <result column="ICREATE" jdbcType="VARCHAR" property="icreate" />
    <result column="DCREATE" jdbcType="TIMESTAMP" property="dcreate" />
  </resultMap>
  
   <select id="selectByPrimaryKey" parameterClass="com.tlg.prpins.entity.FirApsCtbcHandler" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 10 14:00:16 CST 2020.
    -->
    select * 
    from FIR_APS_CTBC_HANDLER
    where OID = #oid:DECIMAL#
  </select>

	<select id="selectByParams" parameterClass="java.util.Map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Mar 19 17:18:25 CST 2020.
    -->
		select * from <include refid="Utils.prpinsSchema"/>FIR_APS_CTBC_HANDLER
    	<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="usercode">
				USERCODE = #usercode#
			</isNotEmpty>
		</dynamic>
	</select>
	
	<select id="selectByUpperComocode" parameterClass="java.lang.String" resultClass="java.lang.Integer">
    	SELECT LISTAGG(COMCODE, ',') 
			WITHIN GROUP (ORDER BY COMCODE) AS COMCODE 
			FROM (
				SELECT DISTINCT COMCODE FROM FIR_APS_CTBC_HANDLER WHERE UPPERCOMCODE = #uppercomcode#);
	</select>
</sqlMap>