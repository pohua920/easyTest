<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!-- mantis：FIR0294，處理人員：BJ085，需求單編號：FIR0294 外銀板信續件移回新核心-資料接收排程 start -->
<sqlMap namespace="FirAgtSalesMapping">
  <resultMap class="com.tlg.prpins.entity.FirAgtSalesMapping" id="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 17 14:15:04 CST 2021.
    -->
    <result column="OID" jdbcType="DECIMAL" property="oid" />
    <result column="BUSINESSNATURE" jdbcType="VARCHAR" property="businessnature" />
    <result column="BRANCH_NO" jdbcType="VARCHAR" property="branchNo" />
    <result column="BRANCH_NAME" jdbcType="VARCHAR" property="branchName" />
    <result column="HANDLER1CODE" jdbcType="VARCHAR" property="handler1code" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="DELETE_FLAG" jdbcType="VARCHAR" property="deleteFlag" />
    <result column="ICREATE" jdbcType="VARCHAR" property="icreate" />
    <result column="DCREATE" jdbcType="TIMESTAMP" property="dcreate" />
    <result column="IUPDATE" jdbcType="VARCHAR" property="iupdate" />
    <result column="DUPDATE" jdbcType="TIMESTAMP" property="dupdate" />
  </resultMap>
  
  <resultMap id="joinPrpdUserResultMap" class="com.tlg.prpins.entity.FirAgtSalesMapping" >
  	<result column="HANDLER1CODE" property="handler1code" jdbcType="VARCHAR" />
  	<result column="BRANCH_NAME" property="branchName" jdbcType="VARCHAR" />
  	<result column="VALIDSTATUS" jdbcType="VARCHAR" property="validstatus" />
  	<result column="COMCODE" jdbcType="VARCHAR" property="comcode" />
  </resultMap>
  
  <!-- mantis：FIR0310，處理人員：BJ016，需求單編號：FIR0310 住火保經代分行服務人員對照表 START -->
  <resultMap class="com.tlg.aps.vo.Aps017ResultVo" id="APS017ResultMap">
  	<result column="OID" jdbcType="DECIMAL" property="oid" />
    <result column="BUSINESSNATURE" jdbcType="VARCHAR" property="businessnature" />
    <result column="BRANCH_NO" jdbcType="VARCHAR" property="branchNo" />
    <result column="BRANCH_NAME" jdbcType="VARCHAR" property="branchName" />
    <result column="HANDLER1CODE" jdbcType="VARCHAR" property="handler1code" />
    <result column="HANDLER1NAME" jdbcType="VARCHAR" property="handler1name" />
    <result column="COMCODE" jdbcType="VARCHAR" property="comcode" />
    <result column="DELETE_FLAG" jdbcType="VARCHAR" property="deleteFlag" />
  </resultMap>
  
  <resultMap class="com.tlg.aps.vo.Aps017EditVo" id="APS017EditMap">
  	<result column="OID" jdbcType="DECIMAL" property="oid" />
    <result column="BUSINESSNATURE" jdbcType="VARCHAR" property="businessnature" />
    <result column="BRANCH_NO" jdbcType="VARCHAR" property="branchNo" />
    <result column="BRANCH_NAME" jdbcType="VARCHAR" property="branchName" />
    <result column="HANDLER1CODE" jdbcType="VARCHAR" property="handler1code" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="DELETE_FLAG" jdbcType="VARCHAR" property="deleteFlag" />
    <result column="ICREATE" jdbcType="VARCHAR" property="icreate" />
    <result column="DCREATE" jdbcType="TIMESTAMP" property="dcreate" />
    <result column="IUPDATE" jdbcType="VARCHAR" property="iupdate" />
    <result column="DUPDATE" jdbcType="TIMESTAMP" property="dupdate" />
    
    <result column="HANDLER1NAME" jdbcType="VARCHAR" property="handler1name" />
    <result column="COMCODE" jdbcType="VARCHAR" property="comcode" />
    <result column="COMCNAME" jdbcType="VARCHAR" property="comcname" />
    <result column="CODECNAME" jdbcType="VARCHAR" property="codecname" />
  </resultMap>
  <!-- mantis：FIR0310，處理人員：BJ016，需求單編號：FIR0310 住火保經代分行服務人員對照表 END -->
  
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 17 14:15:04 CST 2021.
    -->
    OID, BUSINESSNATURE, BRANCH_NO, BRANCH_NAME, HANDLER1CODE, REMARK, DELETE_FLAG, ICREATE, 
    DCREATE, IUPDATE, DUPDATE
  </sql>
  
  <select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*) FROM <include refid="Utils.prpinsSchema"/>FIR_AGT_SALES_MAPPING
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="oid">
				OID = #oid#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="businessnature">
				BUSINESSNATURE = #businessnature#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchNo">
				BRANCH_NO = #branchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchName">
				BRANCH_NAME = #branchName#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1code">
				HANDLER1CODE = #handler1code#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="deleteFlag">
				DELETE_FLAG = #deleteFlag#
			</isNotEmpty>
		</dynamic>
	</select>
	
	<select id="countForAps017" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*) FROM <include refid="Utils.prpinsSchema"/>FIR_AGT_SALES_MAPPING AM
		left join PRPDUSER PU on AM.HANDLER1CODE = PU.USERCODE
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="businessnature">
				AM.BUSINESSNATURE = #businessnature#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchNo">
				AM.BRANCH_NO = #branchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchName">
				AM.BRANCH_NAME = #branchName#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchNameLike">
				AM.BRANCH_NAME like '%'||#branchNameLike#||'%'
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1code">
				AM.HANDLER1CODE = #handler1code#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1name">
				PU.USERNAME = #handler1name#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1nameLike">
				PU.USERNAME like '%'||#handler1nameLike#||'%'
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="comcode">
				PU.COMCODE = #comcode#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="deleteFlag">
				AM.DELETE_FLAG = #deleteFlag#
			</isNotEmpty>
		</dynamic>
	</select>
	
	<select id="selectByParams" parameterClass="java.util.Map" resultMap="BaseResultMap">

    select * from <include refid="Utils.prpinsSchema"/>FIR_AGT_SALES_MAPPING
    	<dynamic prepend="WHERE">
    		<isNotEmpty prepend="AND" property="oid">
				OID = #oid#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="businessnature">
				BUSINESSNATURE = #businessnature#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchNo">
				BRANCH_NO = #branchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchName">
				BRANCH_NAME = #branchName#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1code">
				HANDLER1CODE = #handler1code#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="deleteFlag">
				DELETE_FLAG = #deleteFlag#
			</isNotEmpty>
		</dynamic>
  </select>
  
  <select id="select" parameterClass="java.util.Map" resultMap="BaseResultMap">
  	<include refid="Utils.sql1"/>
	 select 
    <include refid="FirAgtSalesMapping.Base_Column_List" />
    from <include refid="Utils.prpinsSchema"/>FIR_AGT_SALES_MAPPING
    <dynamic prepend="WHERE">
    		<isNotEmpty prepend="AND" property="oid">
				OID = #oid#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="businessnature">
				BUSINESSNATURE = #businessnature#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchNo">
				BRANCH_NO = #branchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchName">
				BRANCH_NAME = #branchName#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1code">
				HANDLER1CODE = #handler1code#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="deleteFlag">
				DELETE_FLAG = #deleteFlag#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startCreateDate">
				DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endCreateDate">
				DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
    </dynamic>
    <isNotEmpty property="sotrBy">
		ORDER BY $sortBy$ $sortType$ 
	</isNotEmpty>
    <include refid="Utils.sql2"/>
  </select>
  
  <select id="selectForAps017" parameterClass="java.util.Map" resultMap="APS017ResultMap">
  	<include refid="Utils.sql1"/>
	 select 
    AM.*, PU.USERNAME AS HANDLER1NAME, PU.COMCODE
    from <include refid="Utils.prpinsSchema"/>FIR_AGT_SALES_MAPPING AM
    left join PRPDUSER PU on AM.HANDLER1CODE = PU.USERCODE
    <dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="businessnature">
				AM.BUSINESSNATURE = #businessnature#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchNo">
				AM.BRANCH_NO = #branchNo#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchName">
				AM.BRANCH_NAME = #branchName#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="branchNameLike">
				AM.BRANCH_NAME like '%'||#branchNameLike#||'%'
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1code">
				AM.HANDLER1CODE = #handler1code#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1name">
				PU.USERNAME = #handler1name#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="handler1nameLike">
				PU.USERNAME like '%'||#handler1nameLike#||'%'
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="comcode">
				PU.COMCODE = #comcode#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startCreateDate">
				DCREATE <![CDATA[>=]]> to_date(#startCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endCreateDate">
				DCREATE <![CDATA[<=]]> to_date(#endCreateDate# , 'yyyy/mm/dd hh24:mi:ss')
			</isNotEmpty>
    </dynamic>
    <isNotEmpty property="sotrBy">
		ORDER BY $sortBy$ $sortType$ 
	</isNotEmpty>
    <include refid="Utils.sql2"/>
  </select>
  
  <select id="selectByPrimaryKey" parameterClass="com.tlg.prpins.entity.FirAgtSalesMapping" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 17 14:15:04 CST 2021.
    -->
    select 
    <include refid="FirAgtSalesMapping.Base_Column_List" />
    from FIR_AGT_SALES_MAPPING
    where OID = #oid:DECIMAL#
  </select>
  <select id="selectByOidForAps017" parameterClass="java.math.BigDecimal" resultMap="APS017EditMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 17 14:15:04 CST 2021.
    -->
    select 
    AM.*, PU.USERNAME AS HANDLER1NAME, PU.COMCODE, PC.COMCNAME, PN.CODECNAME
    from FIR_AGT_SALES_MAPPING AM
    LEFT JOIN PRPDUSER PU ON AM.HANDLER1CODE = PU.USERCODE 
    LEFT JOIN PRPDCOMPANY PC ON PU.COMCODE = PC.COMCODE 
    LEFT JOIN PRPDNEWCODE PN ON AM.BUSINESSNATURE = PN.CODECODE AND PN.CODETYPE = 'BusinessChannel' 
    where AM.OID = #oid:DECIMAL#
  </select>
  
  <select id="selectByBranchNo" resultMap="joinPrpdUserResultMap" parameterClass="java.util.Map">
		select FAS.HANDLER1CODE, FAS.BRANCH_NAME, PU.COMCODE, PU.VALIDSTATUS 
		from <include refid="Utils.prpinsSchema"/>FIR_AGT_SALES_MAPPING FAS
		join PRPDUSER PU on FAS.HANDLER1CODE = PU.USERCODE
		where FAS.BUSINESSNATURE = 'I99065' 
		<isNotEmpty prepend="AND">
			FAS.BRANCH_NO = #branchNo#
		</isNotEmpty>
	</select>
  
  <delete id="delete" parameterClass="com.tlg.prpins.entity.FirAgtSalesMapping">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 17 14:15:04 CST 2021.
    -->
    delete from FIR_AGT_SALES_MAPPING
    where OID = #oid:DECIMAL#
  </delete>
  
  <insert id="insert" parameterClass="com.tlg.prpins.entity.FirAgtSalesMapping">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 17 14:15:04 CST 2021.
    -->
    <selectKey resultClass="java.math.BigDecimal" keyProperty="oid" >    
		SELECT FIR_AGT_SALES_MAPPING_SEQ.NEXTVAL AS OID FROM DUAL    
	</selectKey>
    
    insert into FIR_AGT_SALES_MAPPING (OID, BUSINESSNATURE, BRANCH_NO, BRANCH_NAME, 
      HANDLER1CODE, REMARK, DELETE_FLAG, ICREATE, 
      DCREATE, IUPDATE, DUPDATE)
    values (#oid:DECIMAL#, #businessnature:VARCHAR#, #branchNo:VARCHAR#, #branchName:VARCHAR#, 
      #handler1code:VARCHAR#, #remark:VARCHAR#, #deleteFlag:VARCHAR#, #icreate:VARCHAR#, 
      #dcreate:TIMESTAMP#, #iupdate:VARCHAR#, #dupdate:TIMESTAMP#)
  </insert>

  <update id="update" parameterClass="com.tlg.prpins.entity.FirAgtSalesMapping">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon May 17 14:15:04 CST 2021.
    -->
    update FIR_AGT_SALES_MAPPING
    <dynamic prepend="set">
      <isNotNull prepend="," property="businessnature">
        BUSINESSNATURE = #businessnature:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="branchNo">
        BRANCH_NO = #branchNo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="branchName">
        BRANCH_NAME = #branchName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="handler1code">
        HANDLER1CODE = #handler1code:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="remark">
        REMARK = #remark:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="deleteFlag">
        DELETE_FLAG = #deleteFlag:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="icreate">
        ICREATE = #icreate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dcreate">
        DCREATE = #dcreate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="iupdate">
        IUPDATE = #iupdate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="dupdate">
        DUPDATE = #dupdate:TIMESTAMP#
      </isNotNull>
    </dynamic>
    where OID = #oid:DECIMAL#
  </update>
  
</sqlMap>