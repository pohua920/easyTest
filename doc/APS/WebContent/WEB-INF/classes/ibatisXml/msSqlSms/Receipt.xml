<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Receipt">

	<resultMap id="BaseResultMap" class="com.tlg.msSqlSms.entity.Receipt" >
	    <result column="OID" property="oid" jdbcType="DECIMAL" />
	    <result column="MESSAGE_ID" property="messageId" jdbcType="VARCHAR" />
	    <result column="DEST_ADDRESS" property="destAddress" jdbcType="VARCHAR" />
	    <result column="DELIVERYSTATUS" property="deliveryStatus" jdbcType="VARCHAR" />
	    <result column="ERROR_CODE" property="errorCode" jdbcType="VARCHAR" />
	    <result column="SUBMIT_DATE" property="submitDate" jdbcType="VARCHAR" />
	    <result column="DONE_DATE" property="doneDate" jdbcType="VARCHAR" />
	    <result column="RETRIEVE_DATE" property="retrieveDate" jdbcType="VARCHAR" />
	    <result column="SEQ" property="seq" jdbcType="VARCHAR" />
	</resultMap>

	<select id="select" resultMap="BaseResultMap" parameterClass="java.util.Map">
		<include refid="Utils.sql1" />
		SELECT * FROM <include refid="Utils.msSqlSmsSchema"/>RECEIPT
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="oid">
				OID = #oid#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="messageId">
				MESSAGE_ID = #messageId#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="destAddress">
				DEST_ADDRESS = #destAddress#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="seq">
				SEQ = #seq#
			</isNotEmpty>
		</dynamic>
		<include refid="Utils.sql2" />
	</select>

	<select id="selectByParams" resultMap="BaseResultMap" parameterClass="java.util.Map">
		SELECT * FROM <include refid="Utils.msSqlSmsSchema"/>RECEIPT
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="oid">
				OID = #oid#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="messageId">
				MESSAGE_ID = #messageId#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="destAddress">
				DEST_ADDRESS = #destAddress#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="seq">
				SEQ = #seq#
			</isNotEmpty>
		</dynamic>
	</select>
 	
	<select id="count" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		SELECT COUNT(*) FROM <include refid="Utils.msSqlSmsSchema"/>RECEIPT
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="oid">
				OID = #oid#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="messageId">
				MESSAGE_ID = #messageId#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="destAddress">
				DEST_ADDRESS = #destAddress#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="seq">
				SEQ = #seq#
			</isNotEmpty>
		</dynamic>
	</select>

	<select id="selectByUK" resultClass="com.tlg.msSqlSms.entity.Receipt" parameterClass="java.util.Map" >
		SELECT * FROM <include refid="Utils.msSqlSmsSchema"/>RECEIPT
		WHERE MESSAGE_ID = #messageId#
		AND DEST_ADDRESS = #destAddress#
		AND SEQ = #seq#
	</select>

	<select id="countByUK" resultClass="java.lang.Integer" parameterClass="com.tlg.msSqlSms.entity.Receipt" >
		SELECT COUNT(*) FROM <include refid="Utils.msSqlSmsSchema"/>RECEIPT
		WHERE MESSAGE_ID = #messageId#
		AND DEST_ADDRESS = #destAddress#
		AND SEQ = #seq#
	</select>	

	 	
	<insert id="insert" parameterClass="com.tlg.msSqlSms.entity.Receipt" >
		insert into <include refid="Utils.msSqlSmsSchema"/>RECEIPT (MESSAGE_ID, DEST_ADDRESS, DELIVERYSTATUS, 
		ERROR_CODE, SUBMIT_DATE, DONE_DATE, RETRIEVE_DATE, SEQ)
    	values (#messageId:VARCHAR#, #destAddress:VARCHAR#, #deliveryStatus:VARCHAR#, #errorCode:VARCHAR#, 
    	#submitDate:VARCHAR#, #doneDate:VARCHAR#, #retrieveDate:VARCHAR#, #seq:VARCHAR#)
	</insert>


	<update id="update" parameterClass="com.tlg.msSqlSms.entity.Receipt">
		UPDATE <include refid="Utils.msSqlSmsSchema" />RECEIPT
		<dynamic prepend="set">
			<isNotNull prepend="," property="deliveryStatus">
				DELIVERYSTATUS = #deliveryStatus:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="errorCode">
				ERROR_CODE = #errorCode:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="submitDate">
				SUBMIT_DATE = #submitDate:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="doneDate">
				DONE_DATE = #doneDate:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="retrieveDate">
				RETRIEVE_DATE = #retrieveDate:VARCHAR#
			</isNotNull>
		</dynamic>
		where OID = #oid:DECIMAL#
	</update>

</sqlMap>