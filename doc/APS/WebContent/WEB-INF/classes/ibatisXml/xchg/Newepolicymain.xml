<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Newepolicymain">
  <resultMap class="com.tlg.xchg.entity.Newepolicymain" id="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 28 15:17:10 CST 2021.
    -->
    <result column="FILENAME" jdbcType="VARCHAR" property="filename" />
    <result column="POLICYNO" jdbcType="VARCHAR" property="policyno" />
    <result column="ENDORSENO" jdbcType="VARCHAR" property="endorseno" />
    <result column="ENDORSECONTENT" jdbcType="VARCHAR" property="endorsecontent" />
    <result column="APPLICANTNAME" jdbcType="VARCHAR" property="applicantname" />
    <result column="APPLICANTID" jdbcType="VARCHAR" property="applicantid" />
    <result column="APPLICANTEMAIL" jdbcType="VARCHAR" property="applicantemail" />
    <result column="INSUREDID" jdbcType="VARCHAR" property="insuredid" />
    <result column="INSUREDNAME" jdbcType="VARCHAR" property="insuredname" />
    <result column="STARTDATE" jdbcType="TIMESTAMP" property="startdate" />
    <result column="ENDDATE" jdbcType="TIMESTAMP" property="enddate" />
    <result column="RISKCODE" jdbcType="VARCHAR" property="riskcode" />
    <result column="EPSTATUS" jdbcType="VARCHAR" property="epstatus" />
    <result column="TYPE" jdbcType="VARCHAR" property="type" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="ZIPFILENAME" jdbcType="VARCHAR" property="zipfilename" />
    <result column="RECORDATE" jdbcType="TIMESTAMP" property="recordate" />
    <result column="UNDERWRITEENDDATE" jdbcType="TIMESTAMP" property="underwriteenddate" />
    <result column="EMAILDATE" jdbcType="TIMESTAMP" property="emaildate" />
    <result column="PRINTNO" jdbcType="VARCHAR" property="printno" />
    <result column="SMSDATE" jdbcType="TIMESTAMP" property="smsdate" />
    <result column="MOBILE" jdbcType="VARCHAR" property="mobile" />
    <result column="EPOLICYMAIN" jdbcType="VARCHAR" property="epolicymain" />
    <result column="EPOLICYKIND" jdbcType="VARCHAR" property="epolicykind" />
    <result column="EPOLICYTERMS" jdbcType="VARCHAR" property="epolicyterms" />
    <result column="PREMIUM" jdbcType="VARCHAR" property="premium" />
  </resultMap>
  
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 28 15:17:10 CST 2021.
    -->
    A.FILENAME, A.POLICYNO, A.ENDORSENO, A.ENDORSECONTENT, A.APPLICANTNAME, A.APPLICANTID, 
    A.APPLICANTEMAIL, A.INSUREDID, A.INSUREDNAME, A.STARTDATE, A.ENDDATE, A.RISKCODE, A.EPSTATUS, 
    A.TYPE, A.REMARK, A.ZIPFILENAME, A.RECORDATE, A.UNDERWRITEENDDATE, A.EMAILDATE, A.PRINTNO, 
    B.SMSDATE, B.MOBILE, A.EPOLICYMAIN, A.EPOLICYKIND, A.EPOLICYTERMS, A.PREMIUM
  </sql>

  <select id="selectForFirBatchSendmail" parameterClass="java.util.Map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 28 15:17:10 CST 2021.
    -->
    select 
    <include refid="Newepolicymain.Base_Column_List" />
    from NEWEPOLICYMAIN A
    LEFT JOIN EPOLICYMAINSMS B ON A.FILENAME = B.FILENAME
    <dynamic prepend="WHERE">
		<isNotEmpty prepend="AND" property="policyno">
			POLICYNO = #policyno#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="filename">
			FILENAME = #filename#
		</isNotEmpty>
	</dynamic>
	AND (A.EMAILDATE is not null OR B.SMSDATE is not null)
  </select>
  
	<select id="countByUK" resultClass="java.lang.Integer" parameterClass="com.tlg.xchg.entity.Newepolicymain" >
		SELECT COUNT(*) FROM NEWEPOLICYMAIN
		where FILENAME = #filename:VARCHAR#
	</select>
  
  <insert id="insert" parameterClass="com.tlg.xchg.entity.Newepolicymain">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri May 28 15:17:10 CST 2021.
    -->
    insert into NEWEPOLICYMAIN (FILENAME, POLICYNO, ENDORSENO, ENDORSECONTENT, 
      APPLICANTNAME, APPLICANTID, APPLICANTEMAIL, INSUREDID, 
      INSUREDNAME, STARTDATE, ENDDATE, RISKCODE, 
      EPSTATUS, TYPE, REMARK, ZIPFILENAME, RECORDATE, 
      UNDERWRITEENDDATE, EMAILDATE, PRINTNO,EPOLICYMAIN,EPOLICYKIND,EPOLICYTERMS,PREMIUM)
    values (#filename:VARCHAR#, #policyno:VARCHAR#, #endorseno:VARCHAR#, #endorsecontent:VARCHAR#, 
      #applicantname:VARCHAR#, #applicantid:VARCHAR#, #applicantemail:VARCHAR#, #insuredid:VARCHAR#, 
      #insuredname:VARCHAR#, #startdate:TIMESTAMP#, #enddate:TIMESTAMP#, #riskcode:VARCHAR#, 
      #epstatus:VARCHAR#, #type:VARCHAR#, #remark:VARCHAR#, #zipfilename:VARCHAR#, #recordate:TIMESTAMP#, 
      #underwriteenddate:TIMESTAMP#, #emaildate:TIMESTAMP#, #printno:VARCHAR#,
      #epolicymain:VARCHAR#, #epolicykind:VARCHAR#, #epolicyterms:VARCHAR#, #premium:VARCHAR#)
  </insert>

</sqlMap>