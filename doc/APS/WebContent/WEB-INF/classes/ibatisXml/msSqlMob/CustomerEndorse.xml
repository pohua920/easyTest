<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="CustomerEndorse">
	<resultMap class="com.tlg.msSqlMob.entity.CustomerEndorse" id="BaseResultMap">
	    <result column="transaction_id" property="transactionId" jdbcType="VARCHAR" />
	    <result column="contract_id" property="contractId" jdbcType="VARCHAR" />
	    <result column="policy_no" property="policyNo" jdbcType="VARCHAR" />
	    <result column="endorse_no" property="endorseNo" jdbcType="VARCHAR" />
	    <result column="endorse_type" property="endorseType" jdbcType="VARCHAR" />
	    <result column="endorse_date" property="endorseDate" jdbcType="VARCHAR" />
	    <result column="endorse_content" property="endorseContent" jdbcType="VARCHAR" />
	    <result column="start_date" property="startDate" jdbcType="VARCHAR" />
	    <result column="end_date" property="endDate" jdbcType="VARCHAR" />
	    <result column="msisdn" property="msisdn" jdbcType="VARCHAR" />
	    <result column="pay_period" property="payPeriod" jdbcType="VARCHAR" />
	    <result column="pay_period_start_date" property="payPeriodStartDate" jdbcType="VARCHAR" />
	    <result column="pay_period_end_date" property="payPeriodEndDate" jdbcType="VARCHAR" />
	    <result column="project_code_premium" property="projectCodePremium" jdbcType="VARCHAR" />
	    <result column="created_by" property="createdBy" jdbcType="VARCHAR" />
	    <result column="created_time" property="createdTime" jdbcType="TIMESTAMP" />
	    <result column="modified_by" property="modifiedBy" jdbcType="VARCHAR" />
	    <result column="modified_time" property="modifiedTime" jdbcType="TIMESTAMP" />
	    <result column="data_status" property="dataStatus" jdbcType="VARCHAR" />
	    <result column="ctbc_aml_status" property="ctbcAmlStatus" jdbcType="VARCHAR" />
	    <result column="ctbc_blacklist_status" property="ctbcBlacklistStatus" jdbcType="VARCHAR" />
	    <result column="ctbc_stockholder_status" property="ctbcStockholderStatus" jdbcType="VARCHAR" />
	    <!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 START -->
    	<result column="data_src" jdbcType="VARCHAR" property="dataSrc" />
    	<result column="tx_id" jdbcType="VARCHAR" property="txId" />
    	<result column="ctbc_rcv_no" jdbcType="VARCHAR" property="ctbcRcvNo" />
    	<result column="refund_amount" jdbcType="INTEGER" property="refundAmount" />
    	<result column="endorse_apply_file_name" jdbcType="VARCHAR" property="endorseApplyFileName" />
    	<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 END -->
	</resultMap>


	<select id="select" parameterClass="java.util.Map" resultMap="BaseResultMap">
		<include refid="Utils.msSql1" />
		select * from CUSTOMER_ENDORSE
		<dynamic prepend="WHERE">
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 START -->
			<isNotEmpty prepend="AND" property="dataSrc">
				data_src = #dataSrc:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="transactionId">
				transaction_id = #transactionId:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="txId">
				tx_id = #txId:VARCHAR#
			</isNotEmpty>
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 END -->
			<isNotEmpty prepend="AND" property="contractId">
				contract_id = #contractId:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="policyNo">
				policy_no = #policyNo:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endorseNo">
				endorse_no = #endorseNo:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcAmlStatus">
				ctbc_aml_status = #ctbcAmlStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcBlacklistStatus">
				ctbc_blacklist_status = #ctbcBlacklistStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcStockholderStatus">
				ctbc_stockholder_status = #ctbcStockholderStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="dataStatus">
				data_status = #dataStatus#
			</isNotEmpty>
		</dynamic>
		<include refid="Utils.msSql2" />
	</select>

	<select id="selectByParams" parameterClass="java.util.Map" resultMap="BaseResultMap">
		select * from CUSTOMER_ENDORSE
		<dynamic prepend="WHERE">
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 START -->
			<isNotEmpty prepend="AND" property="dataSrc">
				data_src = #dataSrc:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="transactionId">
				transaction_id = #transactionId:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="txId">
				tx_id = #txId:VARCHAR#
			</isNotEmpty>
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 END -->
			<isNotEmpty prepend="AND" property="contractId">
				contract_id = #contractId:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="policyNo">
				policy_no = #policyNo:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endorseNo">
				endorse_no = #endorseNo:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcAmlStatus">
				ctbc_aml_status = #ctbcAmlStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcBlacklistStatus">
				ctbc_blacklist_status = #ctbcBlacklistStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcStockholderStatus">
				ctbc_stockholder_status = #ctbcStockholderStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="dataStatus">
				data_status = #dataStatus#
			</isNotEmpty>
		</dynamic>
	</select>
	<!--  mantis：MOB0026，處理人員：CE035，需求單編號：MOB0026 優化手機險對帳流程   ac檔補批單號 START -->
	<resultMap class="com.tlg.msSqlMob.entity.CustomerEndorse" id="selectCeToCorrectEndorseNoMap">
	    <result column="contract_id" property="contractId" jdbcType="VARCHAR" />
	    <result column="policy_no" property="policyNo" jdbcType="VARCHAR" />
	    <result column="endorse_no" property="endorseNo" jdbcType="VARCHAR" />
	    <result column="endorse_date" property="endorseDate" jdbcType="VARCHAR" />
	    <result column="pay_period" property="payPeriod" jdbcType="VARCHAR" />
	    <result column="pay_period_start_date" property="payPeriodStartDate" jdbcType="VARCHAR" />
	    <result column="pay_period_end_date" property="payPeriodEndDate" jdbcType="VARCHAR" />
	    <result column="project_code_premium" property="projectCodePremium" jdbcType="VARCHAR" />
	</resultMap>
	<select id="selectCeToCorrectEndorseNo" parameterClass="java.util.Map" resultMap="selectCeToCorrectEndorseNoMap">
		SELECT contract_id,policy_no,endorse_no,endorse_date,pay_period,pay_period_start_date,pay_period_end_date,project_code_premium 
		FROM CUSTOMER_ENDORSE 
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="endorseDate">
				endorse_date = #endorseDate# AND project_code_premium != 0 AND (pay_period = '' OR pay_period = 1) 
			</isNotEmpty>
		</dynamic>
	</select>
	<!--  mantis：MOB0026，處理人員：CE035，需求單編號：MOB0026 優化手機險對帳流程   ac檔補批單號 END -->

	<select id="count" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		select COUNT(*) from CUSTOMER_ENDORSE
		<dynamic prepend="WHERE">
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 START -->
			<isNotEmpty prepend="AND" property="dataSrc">
				data_src = #dataSrc:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="transactionId">
				transaction_id = #transactionId:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="txId">
				tx_id = #txId:VARCHAR#
			</isNotEmpty>
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 END -->
			<isNotEmpty prepend="AND" property="contractId">
				contract_id = #contractId:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="policyNo">
				policy_no = #policyNo:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endorseNo">
				endorse_no = #endorseNo:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcAmlStatus">
				ctbc_aml_status = #ctbcAmlStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcBlacklistStatus">
				ctbc_blacklist_status = #ctbcBlacklistStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="ctbcStockholderStatus">
				ctbc_stockholder_status = #ctbcStockholderStatus:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="dataStatus">
				data_status = #dataStatus#
			</isNotEmpty>
		</dynamic>
	</select>

	<delete id="deleteByEntity" parameterClass="com.tlg.msSqlMob.entity.CustomerEndorse">
		delete from CUSTOMER_ENDORSE
		where transaction_id = #transactionId:VARCHAR#
	</delete>

	<select id="selectByUK" resultMap="BaseResultMap"
		parameterClass="java.util.Map">
		SELECT * FROM CUSTOMER_ENDORSE
		where transaction_id = #transactionId:VARCHAR#
	</select>

	<select id="countByUK" resultClass="java.lang.Integer"
		parameterClass="com.tlg.msSqlMob.entity.CustomerEndorse">
		SELECT COUNT(*) FROM CUSTOMER_ENDORSE
		where transaction_id = #transactionId:VARCHAR#
	</select>

	<insert id="insert" parameterClass="com.tlg.msSqlMob.entity.CustomerEndorse">
	    insert into CUSTOMER_ENDORSE (transaction_id, contract_id, policy_no, endorse_no, endorse_type,
	      endorse_date, endorse_content, start_date, end_date, msisdn, pay_period,
	      pay_period_start_date, pay_period_end_date, project_code_premium, created_by, created_time,
	      data_status, ctbc_aml_status, ctbc_blacklist_status,
	      <!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 START -->
	      ctbc_stockholder_status,data_src,tx_id,ctbc_rcv_no,refund_amount,endorse_apply_file_name)
	    values (#transactionId:VARCHAR#, #contractId:VARCHAR#, #policyNo:VARCHAR#, #endorseNo:VARCHAR#,
	      #endorseType:VARCHAR#, #endorseDate:VARCHAR#, #endorseContent:VARCHAR#, #startDate:VARCHAR#,
	      #endDate:VARCHAR#, #msisdn:VARCHAR#, #payPeriod:VARCHAR#, #payPeriodStartDate:VARCHAR#,
	      #payPeriodEndDate:VARCHAR#, #projectCodePremium:VARCHAR#, #createdBy:VARCHAR#,
	      #createdTime:TIMESTAMP#, #dataStatus:VARCHAR#,
	      #ctbcAmlStatus:VARCHAR#, #ctbcBlacklistStatus:VARCHAR#, #ctbcStockholderStatus:VARCHAR#,
	      #dataSrc:VARCHAR#, #txId:VARCHAR#, #ctbcRcvNo:VARCHAR#, #refundAmount:INTEGER#, #endorseApplyFileName:VARCHAR#)
	      <!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 END -->
	</insert>

	<update id="update" parameterClass="com.tlg.msSqlMob.entity.CustomerEndorse">
		update CUSTOMER_ENDORSE
		<dynamic prepend="set">
			<isNotNull prepend="," property="contractId">
				contract_id = #contractId:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="policyNo">
				policy_no = #policyNo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="endorseNo">
				endorse_no = #endorseNo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="endorseType">
				endorse_type = #endorseType:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="endorseDate">
				endorse_date = #endorseDate:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="endorseContent">
				endorse_content = #endorseContent:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="startDate">
				start_date = #startDate:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="endDate">
				end_date = #endDate:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="msisdn">
				msisdn = #msisdn:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="payPeriod">
				pay_period = #payPeriod:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="payPeriodStartDate">
				pay_period_start_date = #payPeriodStartDate:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="payPeriodEndDate">
				pay_period_end_date = #payPeriodEndDate:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="projectCodePremium">
				project_code_premium = #projectCodePremium:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="modifiedBy">
				modified_by = #modifiedBy:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="modifiedTime">
				modified_time = #modifiedTime:TIMESTAMP#
			</isNotNull>
			<isNotNull prepend="," property="dataStatus">
				data_status = #dataStatus:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="ctbcAmlStatus">
				ctbc_aml_status = #ctbcAmlStatus:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="ctbcBlacklistStatus">
				ctbc_blacklist_status = #ctbcBlacklistStatus:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="ctbcStockholderStatus">
				ctbc_stockholder_status = #ctbcStockholderStatus:VARCHAR#
			</isNotNull>
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 START -->
			<isNotNull prepend="," property="dataSrc">
				data_src = #dataSrc:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="txId">
				tx_id = #txId:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="ctbcRcvNo">
				ctbc_rcv_no = #ctbcRcvNo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="refundAmount">
				refund_amount = #refundAmount:INTEGER#
			</isNotNull>
			<isNotNull prepend="," property="endorseApplyFileName">
				endorse_apply_file_name = #endorseApplyFileName:VARCHAR#
			</isNotNull>
			<!-- mantis：MOB0031，處理人員：CE035，需求單編號：MOB0031 行動裝置險estore網投案開發 出單流程 END -->
		</dynamic>
		where transaction_id = #transactionId:VARCHAR#
	</update>
</sqlMap>